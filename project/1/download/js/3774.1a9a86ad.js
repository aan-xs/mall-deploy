"use strict";(self["webpackChunkbk_pc"]=self["webpackChunkbk_pc"]||[]).push([[3774],{6098:function(e,a,l){l.d(a,{d:function(){return t}});const t=()=>{const e=async(e,a,l)=>{e.createdAt&&(e.fromTime=e.createdAt[0],e.toTime=e.createdAt[1],delete e.createdAt),await a(e),l()},a=async(e,a)=>{await a(e)};return{search:e,reset:a}}},22416:function(e,a,l){l.d(a,{Z:function(){return o}});var t=l(40130),r=l(47178),n=l(40670);function o(){const e=e=>{const a=e.type,l="add"===a?"新增":"编辑";n.Z.dialog({showLang:!0,langTogether:!0,dialog:{width:"80%",title:l+"奖品"},modelField:"data",data:{password:""},params:{option:{labelPosition:"left",column:[{label:"奖品图片",prop:"imgUrl",listType:"picture-img",tip:"建议尺寸200*200px",type:"upload",span:24,action:"/api/admin/upload",rules:[{required:!0,message:"请上传图片",trigger:"blur"}],data:{moduleName:"type"},propsHttp:{res:"data",url:"url"},headers:{}},{label:"奖品名称",prop:"link",placeholder:"请输入奖品名称",span:24,rules:[{required:!0,message:"请输入奖品名称",trigger:"blur"}]},{label:"奖品价值",prop:"link",placeholder:"请输入奖品价值",type:"number",span:24,rules:[{required:!0,message:"请输入奖品价值",trigger:"blur"}]},{label:"类型名称",prop:"imgType",type:"select",span:24,rules:[{required:!0,message:"请选择分类",trigger:"blur"}],dicData:[{label:"小图",value:0},{label:"大图",value:1}]},{label:"备注",prop:"remarks",placeholder:"请输入备注",span:24,type:"textarea",rows:3,rules:[{required:!0,message:"请输入备注",trigger:"blur"}]}]}},ok(e,a){e()},cancel(){}})},a=(e,a,l)=>{t.T.confirm("确定要删除该吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{a(e).then((e=>{(0,r.z8)({type:"success",message:"删除成功"}),l({})})).catch((e=>{(0,r.z8)({type:"error",message:"删除失败"})}))})).catch((()=>{(0,r.z8)({type:"info",message:"Delete canceled"})}))};return{prizeManage:e,prizeDelete:a}}},33774:function(e,a,l){l.r(a),l.d(a,{default:function(){return C}});var t=l(73396),r=l(87139),n=l(44870),o=l(22416);const p={editBtn:!1,delBtn:!1,stripe:!0,border:!0,addBtn:!1,searchSpan:7,searchMenuSpan:24,searchGutter:50,columnBtn:!0,align:"center",searchMenuPosition:"right",menuWidth:130,column:[{label:"活动名称",prop:"lotteryName",width:180},{label:"领取用户ID",prop:"uid",width:180,search:!0,searchLabelWidth:100},{label:"领取用户名称",prop:"partyName",width:180},{label:"用户账号",prop:"username",search:!0,hide:!0},{label:"店铺名称",prop:"sellerName",search:!0},{label:"奖品类型",prop:"prizeType",width:180,dicData:[{label:"实物类",value:1},{label:"彩金类",value:2},{label:"谢谢惠顾",value:3}],type:"select",search:!0},{label:"奖品价值",prop:"prizeAmount",width:180},{label:"推荐人",prop:"recommendName",width:180},{label:"派发状态",prop:"state",search:!0,width:180,type:"select",dicData:[{label:"未派发",value:0},{label:"已派发",value:1}]},{label:"创建时间",prop:"createTime",width:180},{label:"申请时间",prop:"applyTime",width:180},{label:"派发时间",prop:"issueTime",width:180},{label:"领取时间",prop:"createdAt",type:"datetime",searchRange:!0,search:!0,hide:!0,startPlaceholder:"时间（开始）",endPlaceholder:"时间（结束）"}]};var u=p,i=l(51826),s=l(7877),d=l(6098),c=l(49242);const m={editBtn:!1,delBtn:!1,stripe:!0,border:!0,addBtn:!1,searchSpan:7,searchMenuSpan:24,searchGutter:50,columnBtn:!0,align:"center",searchMenuPosition:"right",refreshBtn:!1,highlightCurrentRow:!0,menu:!1,column:[{label:"奖品ID",prop:"id"},{label:"奖品名称",prop:"prizeName"},{label:"奖品价值",prop:"prizeAmount"},{label:"数量",prop:"num"}]},h={class:"app-container"};var b={__name:"DispatchRecords",props:{modelValue:{type:Object,required:!0}},emits:["update:modelValue","close","confirm"],setup(e,{expose:a,emit:l}){const r=e,o=(0,n.ref)(!0),p=(0,n.ref)(null);(0,t.bv)((()=>{}));const u=(0,n.ref)({submitBtn:!1,emptyBtn:!1,column:[{label:"用户ID",prop:"partyId",disabled:!0,span:24},{label:"店铺名",prop:"sellerName",disabled:!0,span:24},{label:"奖品类型",prop:"prizeType",disabled:!0,span:24},{label:"奖品价值",prop:"prizeAmount",disabled:!0,span:24},{label:"奖品",prop:"prizeDTOList",span:24}]});r.modelValue?.prizeDTOList||u.value.column.splice(4,1);const i=(0,t.Fl)({get(){return new Proxy(r.modelValue,{get(e,a){return Reflect.get(e,a)},set(e,a,t){return l("update:modelValue",{...e,[a]:t}),!0}})},set(e){l("update:modelValue",e)}}),s=()=>{o.value=!1,l("close")},d=()=>{p.value.submit&&p.value.submit()},b=(e,a)=>{a(),l("confirm")};return a({handleBeforeClose:s}),(e,a)=>{const l=(0,t.up)("el-input"),r=(0,t.up)("avue-crud"),g=(0,t.up)("el-card"),f=(0,t.up)("avue-form"),v=(0,t.up)("el-button"),y=(0,t.up)("el-dialog");return(0,t.wg)(),(0,t.j4)(y,{modelValue:o.value,"onUpdate:modelValue":a[1]||(a[1]=e=>o.value=e),title:"手动派发","before-close":s},{footer:(0,t.w5)((()=>[(0,t.Wm)(v,{type:"primary",onClick:d},{default:(0,t.w5)((()=>[(0,t.Uk)("确定")])),_:1}),(0,t.Wm)(v,{onClick:(0,c.iM)(s,["stop"])},{default:(0,t.w5)((()=>[(0,t.Uk)("取消")])),_:1},8,["onClick"])])),default:(0,t.w5)((()=>[(0,t.Wm)(f,{option:u.value,modelValue:i.value,"onUpdate:modelValue":a[0]||(a[0]=e=>i.value=e),ref_key:"formRef",ref:p,onSubmit:b},{prizeType:(0,t.w5)((()=>[(0,t.Wm)(l,{disabled:"","model-value":1==i.value.prizeType?"实物类":2==i.value.prizeType?"彩金类":"谢谢惠顾"},null,8,["model-value"])])),prizeDTOList:(0,t.w5)((()=>[(0,t._)("div",h,[(0,t.Wm)(g,null,{default:(0,t.w5)((()=>[(0,t.Wm)(r,{option:(0,n.unref)(m),data:i.value.prizeDTOList},null,8,["option","data"])])),_:1})])])),_:1},8,["option","modelValue"])])),_:1},8,["modelValue"])}}};const g=b;var f=g,v=l(44775),y=l(47178),w=l(61073),k={__name:"GetRecords",setup(e){const a=(0,n.ref)(!1),{prizeManage:l}=(0,o.Z)(),{tableRef:p,tableLoading:c,pageObj:m,sizeChange:h,currentChange:b,getTableData:g,tableData:k}=(0,i.D)(s.og,{}),{search:z,reset:C}=(0,d.d)(),T=async(e,a)=>{z(e,g,a)},_=()=>{C({},g)},D=()=>{C({},g)},B=(0,n.ref)({}),V=(0,n.ref)(null),R=e=>{const l=v.kN.service({lock:!0,text:"Loading",background:"rgba(0, 0, 0, 0.4)"});(0,s.MH)({id:e.id}).then((e=>{l.close(),e.data.data.remark="",B.value=e.data.data,a.value=!0}))},W=()=>{setTimeout((()=>{a.value=!1}),500)},U=()=>{(0,s.WI)({id:B.value.id,remark:B.value.remark}).then((e=>{0==e.data.code&&(y.z8.success("派发成功"),V.value?.handleBeforeClose(),g())}))};return(e,l)=>{const o=(0,t.up)("el-button"),i=(0,t.up)("avue-crud"),s=(0,t.up)("el-card");return(0,t.wg)(),(0,t.iD)("div",null,[(0,t._)("div",{class:(0,r.normalizeClass)(["app-container",{"h-90vh":!(0,n.unref)(w.r8)}])},[(0,t.Wm)(s,null,{default:(0,t.w5)((()=>[(0,t.Wm)(i,{ref_key:"tableRef",ref:p,page:(0,n.unref)(m),"onUpdate:page":l[0]||(l[0]=e=>(0,n.isRef)(m)?m.value=e:null),"table-loading":(0,n.unref)(c),onSearchChange:T,onSearchReset:_,onSizeChange:(0,n.unref)(h),onCurrentChange:(0,n.unref)(b),onRefreshChange:D,option:(0,n.unref)(u),data:(0,n.unref)(k)},{state:(0,t.w5)((({row:e})=>[1==e.state?((0,t.wg)(),(0,t.j4)(o,{key:0,type:"success"},{default:(0,t.w5)((()=>[(0,t.Uk)("已派发")])),_:1})):((0,t.wg)(),(0,t.j4)(o,{key:1,type:"danger"},{default:(0,t.w5)((()=>[(0,t.Uk)("未派发")])),_:1}))])),menu:(0,t.w5)((({row:e})=>[0==e.state?((0,t.wg)(),(0,t.j4)(o,{key:0,type:"primary",icon:"el-icon-edit",onClick:a=>R(e)},{default:(0,t.w5)((()=>[(0,t.Uk)("派发")])),_:2},1032,["onClick"])):(0,t.kq)("",!0)])),_:1},8,["page","table-loading","onSizeChange","onCurrentChange","option","data"])])),_:1})],2),a.value?((0,t.wg)(),(0,t.j4)(f,{key:0,ref_key:"dispatchRecordsRef",ref:V,modelValue:B.value,"onUpdate:modelValue":l[1]||(l[1]=e=>B.value=e),onClose:W,onConfirm:U},null,8,["modelValue"])):(0,t.kq)("",!0)])}}};const z=k;var C=z}}]);