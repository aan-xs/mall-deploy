"use strict";(self["webpackChunkbk_pc"]=self["webpackChunkbk_pc"]||[]).push([[6804],{26804:function(e,l,a){a.r(l),a.d(l,{default:function(){return O}});a(57658);var t=a(73396),u=a(87139),o=a(44870),d=a(72748),i=a(45715),s=a(22483),n=a(40130),r=a(47178),c=a(60814),m=a(61073),p=a(44161),v=a(16721);const f={class:"commodity-library"},g={class:"font-18"},y={class:"mt-15 select-wrapper"},h={class:"font-14"},w={style:{padding:"5px"}},b={style:{padding:"5px"}},_={class:"my-30"},k={class:"result"},S={class:"font-14"},$={style:{display:"flex","align-items":"center","justify-content":"center",overflow:"hidden",height:"80px"}},W={class:"image-slot"},C={style:{overflow:"hidden","text-overflow":"ellipsis",display:"-webkit-box","-webkit-line-clamp":"2","-webkit-box-orient":"vertical"}},V=["onClick"],D={class:"flex"},I={class:"flex align-center flex-col mr-15"},x={key:0,class:"flex align-center flex-col"},U={key:0,class:"flex justify-center mt-40"},z={class:"font-16"},j={class:"mt-40"},N={class:"font-16"},Z={class:"dialog-footer"};var L={__name:"CommodityLibrary",setup(e){const{t:l}=(0,v.QT)(),a=(0,s.tv)(),L=(0,o.ref)(null),T=(0,o.ref)(!0),E=(0,o.ref)("en"),O=(0,o.ref)({commodityId:"",commodityName:"",categoryId:"",state:"",isShelf:"",updateStatus:"",secondaryCategoryId:""}),q=(0,o.ref)([{value:"",label:l("全部")},{value:"0",label:l("未锁定")},{value:"1",label:l("已锁定")}]),B=(e,l)=>{a.push({path:e,query:{id:l.id}})},P=()=>{Object.keys(O.value).forEach((e=>{O.value[e]=""})),ue()},H=(0,o.ref)(1),Y=(0,o.ref)(10),F=(0,o.ref)(),G=()=>{ue()},K=()=>{ue()},Q=(0,o.ref)(!1),A=(0,o.ref)(""),R=(0,o.ref)(""),J=()=>{},M=()=>{Q.value=!1},X=[{value:"1",label:l("上架")},{value:"0",label:l("下架")}],ee=(0,o.ref)(!1),le=(0,o.ref)({elements:[]}),ae=()=>{ue()},te=(0,o.ref)(!1);(0,t.bv)((()=>{L.value.getProductCategories(),ue()}));const ue=()=>{T.value=!0,te.value=!0;const e={...O.value,id:O.value.commodityId,name:O.value.commodityName,isShelf:O.value.isShelf,categoryId:O.value.categoryId,pageSize:Y.value,pageNum:H.value,updateStatus:O.value.updateStatus};e.categoryId=O.value.categoryId?O.value.categoryId[0]:void 0,e.secondaryCategoryId=O.value.categoryId&&O.value.categoryId.length>1?O.value.categoryId[1]:void 0,ee.value=!0,(0,p.Z)({method:"post",url:`${m.O9}/systemGoods/list.action`,params:e}).then((e=>{ee.value=!1,null!==e.data.data&&(le.value=e.data.data,setTimeout((()=>{L.value.kinds.length>0&&le.value.elements.forEach((e=>{if(e.categoryId){const l=L.value.kinds.find((l=>l.categoryId===e.categoryId));l&&(e.categoryName=l.name,l.subList.length>0&&l.subList.forEach((l=>{l.id===e.secondaryCategoryId&&(e.secondCategoryName=l.name)})))}})),F.value=le.value.totalElements}),300)),setTimeout((()=>{te.value=!1}),1e3),T.value=!1}))},oe=((0,o.ref)(!1),()=>{a.push({path:"/edit-commodity",query:{type:"add"}})}),de=e=>{a.push({path:"/edit-commodity",query:{type:"edit",id:e}})},ie=e=>{e.isShelf;const a=new FormData;a.append("isShelf",e.isShelf),a.append("id",e.id),(0,p.Z)({method:"post",url:`${m.O9}/systemGoods/updateShelf.action`,data:a}).then((a=>{e.isShelf/1===1?(0,r.z8)({type:"success",message:l("上架成功")}):(0,r.z8)({type:"success",message:l("下架成功")})}))},se=e=>{const a=parseInt(e.updateStatus)?"未锁定":"已锁定";n.T.confirm(l(`你确定要修改状态为${a}吗?`),l("警告"),{confirmButtonText:l("确认"),cancelButtonText:l("取消"),type:"warning"}).then((()=>{T.value=!0;const a=e.updateStatus?0:1,t=new FormData;t.append("updateStatus",a),t.append("id",e.id),(0,p.Z)({url:`${m.O9}/systemGoods/updateUpdateStatus.action`,method:"post",data:t}).then((t=>{const u=le.value.elements.findIndex((l=>l.id===e.id));le.value.elements[u].updateStatus=a,(0,r.z8)({type:"success",message:l("修改成功")}),T.value=!1}))})).catch((()=>{(0,r.z8)({type:"info",message:l("取消修改")})}))};return(0,t.dl)((()=>{ue()})),document.addEventListener("visibilitychange",(()=>{"visible"===document.visibilityState&&ue()})),(e,l)=>{const a=(0,t.up)("el-input"),s=(0,t.up)("el-form-item"),n=(0,t.up)("el-option"),r=(0,t.up)("el-select"),m=(0,t.up)("el-button"),p=(0,t.up)("el-form"),v=(0,t.up)("el-table-column"),ue=(0,t.up)("el-icon"),ne=(0,t.up)("el-image"),re=(0,t.up)("el-switch"),ce=(0,t.up)("el-tag"),me=(0,t.up)("el-table"),pe=(0,t.up)("el-pagination"),ve=(0,t.up)("el-config-provider"),fe=(0,t.up)("el-dialog"),ge=(0,t.Q2)("loading");return(0,t.wg)(),(0,t.iD)(t.HY,null,[(0,t._)("div",f,[(0,t._)("div",g,(0,u.toDisplayString)(e.$t("商品列表")),1),(0,t._)("div",y,[(0,t._)("div",h,(0,u.toDisplayString)(e.$t("查询条件")),1),(0,t.Wm)(p,{class:"flex flex-wrap mt-10"},{default:(0,t.w5)((()=>[(0,t.Wm)(s,{class:"mr-50",label:`${e.$t("商品名称")}：`},{default:(0,t.w5)((()=>[(0,t.Wm)(a,{modelValue:O.value.commodityName,"onUpdate:modelValue":l[0]||(l[0]=e=>O.value.commodityName=e),placeholder:e.$t("商品名称")},null,8,["modelValue","placeholder"])])),_:1},8,["label"]),(0,t.Wm)(s,{class:"mr-50",label:`${e.$t("商品ID")}：`},{default:(0,t.w5)((()=>[(0,t.Wm)(a,{modelValue:O.value.commodityId,"onUpdate:modelValue":l[1]||(l[1]=e=>O.value.commodityId=e),placeholder:e.$t("商品ID")},null,8,["modelValue","placeholder"])])),_:1},8,["label"]),(0,t.Wm)(s,{class:"mr-50",label:`${e.$t("商品分类")}：`},{default:(0,t.w5)((()=>[(0,t.Wm)((0,o.unref)(i.Z),{ref_key:"BCategoryRef",ref:L,modelValue:O.value.categoryId,"onUpdate:modelValue":l[2]||(l[2]=e=>O.value.categoryId=e),lang:E.value},null,8,["modelValue","lang"])])),_:1},8,["label"]),(0,t.Wm)(s,{class:"mr-50",label:`${e.$t("商品状态")}：`},{default:(0,t.w5)((()=>[(0,t.Wm)(r,{modelValue:O.value.isShelf,"onUpdate:modelValue":l[3]||(l[3]=e=>O.value.isShelf=e),class:"m-2",placeholder:e.$t("商品状态")},{default:(0,t.w5)((()=>[((0,t.wg)(),(0,t.iD)(t.HY,null,(0,t.Ko)(X,(e=>(0,t.Wm)(n,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),64))])),_:1},8,["modelValue","placeholder"])])),_:1},8,["label"]),(0,t.Wm)(s,{class:"mr-50",label:`${e.$t("锁定状态")}：`},{default:(0,t.w5)((()=>[(0,t.Wm)(r,{modelValue:O.value.updateStatus,"onUpdate:modelValue":l[4]||(l[4]=e=>O.value.updateStatus=e),class:"m-2",placeholder:e.$t("锁定状态")},{default:(0,t.w5)((()=>[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(q.value,(e=>((0,t.wg)(),(0,t.j4)(n,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue","placeholder"])])),_:1},8,["label"]),(0,t.Wm)(s,null,{default:(0,t.w5)((()=>[(0,t._)("div",w,[(0,t.Wm)(m,{type:"primary",onClick:ae,loading:ee.value},{default:(0,t.w5)((()=>[(0,t.Uk)((0,u.toDisplayString)(e.$t("查询")),1)])),_:1},8,["loading"])]),(0,t._)("div",b,[(0,t.Wm)(m,{type:"primary",onClick:P},{default:(0,t.w5)((()=>[(0,t.Uk)((0,u.toDisplayString)(e.$t("重置")),1)])),_:1})])])),_:1})])),_:1})]),(0,t._)("div",_,[(0,t.Wm)(m,{type:"primary",onClick:oe},{default:(0,t.w5)((()=>[(0,t.Uk)((0,u.toDisplayString)(e.$t("新增商品")),1)])),_:1})]),(0,t._)("div",k,[(0,t._)("div",S,(0,u.toDisplayString)(e.$t("查询结果")),1),(0,t.wy)(((0,t.wg)(),(0,t.j4)(me,{class:"mt-15","max-height":"800",data:le.value.elements,border:"",style:{width:"100%"}},{default:(0,t.w5)((()=>[(0,t.Wm)(v,{prop:"id",label:e.$t("商品ID"),width:"130"},null,8,["label"]),(0,t.Wm)(v,{label:e.$t("封面图"),width:"200"},{default:(0,t.w5)((e=>[(0,t._)("div",$,[(0,t.Wm)(ne,{style:{width:"100px",height:"100%"},src:e.row.imgUrl1,fit:"cover"},{error:(0,t.w5)((()=>[(0,t._)("div",W,[(0,t.Wm)(ue,null,{default:(0,t.w5)((()=>[(0,t.Wm)((0,o.unref)(d.tap))])),_:1})])])),_:2},1032,["src"])])])),_:1},8,["label"]),(0,t.Wm)(v,{prop:"goodName",label:e.$t("商品名称")},{default:(0,t.w5)((e=>[(0,t._)("div",C,(0,u.toDisplayString)(e.row.goodName),1)])),_:1},8,["label"]),(0,t.Wm)(v,{prop:"categoryName",label:e.$t("商品分类"),width:"200","class-name":"category"},null,8,["label"]),(0,t.Wm)(v,{prop:"secondCategoryName",label:"二级分类",width:"100","class-name":"category"}),(0,t.Wm)(v,{prop:"systemPrice",label:e.$t("进货价格"),width:"180"},{default:(0,t.w5)((e=>[(0,t._)("div",null,"$"+(0,u.toDisplayString)(e.row.systemPrice.toFixed(2)),1)])),_:1},8,["label"]),(0,t.Wm)(v,{prop:"putOnShelves",label:e.$t("是否上架"),width:"100"},{default:(0,t.w5)((e=>[(0,t.Wm)(re,{"active-value":1,"inactive-value":0,disabled:te.value,modelValue:e.row.isShelf,"onUpdate:modelValue":l=>e.row.isShelf=l,onChange:l=>ie(e.row)},null,8,["disabled","modelValue","onUpdate:modelValue","onChange"])])),_:1},8,["label"]),(0,t.Wm)(v,{label:e.$t("解锁状态"),width:"84"},{default:(0,t.w5)((l=>[(0,t._)("div",{class:"flex justify-center",style:{cursor:"pointer"},onClick:e=>se(l.row)},[l.row.updateStatus?((0,t.wg)(),(0,t.j4)(ce,{key:0,size:"large"},{default:(0,t.w5)((()=>[(0,t.Uk)((0,u.toDisplayString)(e.$t("已锁定")),1)])),_:1})):((0,t.wg)(),(0,t.j4)(ce,{key:1,size:"large",type:"danger"},{default:(0,t.w5)((()=>[(0,t.Uk)((0,u.toDisplayString)(e.$t("未锁定")),1)])),_:1}))],8,V)])),_:1},8,["label"]),(0,t.Wm)(v,{label:e.$t("排序"),width:"80"},null,8,["label"]),(0,t.Wm)(v,{label:e.$t("销量"),width:"100"},null,8,["label"]),(0,t.Wm)(v,{label:e.$t("操作"),width:"250"},{default:(0,t.w5)((l=>[(0,t._)("div",D,[(0,t._)("div",I,[(0,t.Wm)(m,{onClick:e=>B("/comment",l.row)},{default:(0,t.w5)((()=>[(0,t.Uk)((0,u.toDisplayString)(e.$t("评价库")),1)])),_:2},1032,["onClick"]),(0,t.Wm)(m,{class:"mt-10",onClick:e=>B("/member-comments",l.row)},{default:(0,t.w5)((()=>[(0,t.Uk)("会员评价 ")])),_:2},1032,["onClick"])]),l.row.updateStatus?(0,t.kq)("",!0):((0,t.wg)(),(0,t.iD)("div",x,[(0,t.Wm)(m,{type:"primary",onClick:e=>de(l.row.id)},{default:(0,t.w5)((()=>[(0,t.Uk)((0,u.toDisplayString)(e.$t("编辑")),1)])),_:2},1032,["onClick"])]))])])),_:1},8,["label"])])),_:1},8,["data"])),[[ge,T.value]])]),Object.keys(le.value).length>0?((0,t.wg)(),(0,t.iD)("div",U,[(0,t.Wm)(ve,{locale:(0,o.unref)(c.Z)},{default:(0,t.w5)((()=>[(0,t.Wm)(pe,{onSizeChange:K,"current-page":H.value,"onUpdate:currentPage":l[5]||(l[5]=e=>H.value=e),"page-size":Y.value,"onUpdate:pageSize":l[6]||(l[6]=e=>Y.value=e),"page-sizes":[10,20,30,50],background:"",layout:"total, prev, pager, next, jumper",total:F.value,onCurrentChange:G},null,8,["current-page","page-size","total"])])),_:1},8,["locale"])])):(0,t.kq)("",!0)]),(0,t.Wm)(fe,{modelValue:Q.value,"onUpdate:modelValue":l[10]||(l[10]=e=>Q.value=e),title:e.$t("导入链接"),width:"40%",onClose:J},{footer:(0,t.w5)((()=>[(0,t._)("span",Z,[(0,t.Wm)(m,{onClick:l[9]||(l[9]=e=>Q.value=!1),style:{"margin-right":"12px"}},{default:(0,t.w5)((()=>[(0,t.Uk)((0,u.toDisplayString)(e.$t("关闭")),1)])),_:1}),(0,t.Wm)(m,{type:"primary",onClick:M},{default:(0,t.w5)((()=>[(0,t.Uk)((0,u.toDisplayString)(e.$t("确认")),1)])),_:1})])])),default:(0,t.w5)((()=>[(0,t._)("div",null,[(0,t._)("div",z,(0,u.toDisplayString)(e.$t("商品类型")),1),(0,t.Wm)(r,{modelValue:A.value,"onUpdate:modelValue":l[7]||(l[7]=e=>A.value=e),class:"w-full mt-15",placeholder:"Select"},{default:(0,t.w5)((()=>[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(e.options,(e=>((0,t.wg)(),(0,t.j4)(n,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])]),(0,t._)("div",j,[(0,t._)("div",N,(0,u.toDisplayString)(e.$t("商品链接")),1),(0,t.Wm)(a,{class:"mt-15",modelValue:R.value,"onUpdate:modelValue":l[8]||(l[8]=e=>R.value=e),placeholder:e.$t("商品链接")},null,8,["modelValue","placeholder"])])])),_:1},8,["modelValue","title"])],64)}}},T=a(40089);const E=(0,T.Z)(L,[["__scopeId","data-v-cdbd7052"]]);var O=E},45715:function(e,l,a){a.d(l,{Z:function(){return r}});a(57658);var t=a(73396),u=a(44870),o=a(44161),d=a(61073),i=a(16721),s={__name:"BCategory",props:{value:{type:Array,default:()=>[]},all:{type:Boolean,default:!1},lang:{type:String,default:"zh"}},emits:["input"],setup(e,{expose:l,emit:a}){const s=e,{t:n}=(0,i.QT)(),r=(0,u.ref)([]),c=(0,u.ref)([]),m=(0,u.ref)({}),p=e=>{(0,o.Z)({method:"get",url:`${d.vS}/wap/api/category!tree.action?lang=${s.lang}`}).then((l=>{r.value=l.data.data;let a=v(l.data.data,e);a.unshift({value:null,label:n("全部"),children:null}),c.value=a}))},v=(e,l)=>{let a=[];return e.forEach((e=>{let t={value:e.id,label:e.name,children:null};if(e?.subList?.length>0){const a=e.subList.find((e=>e.id===l));t.children=v(e.subList),a?t.children.unshift({value:"0",label:n("全部"),children:null}):t.children.unshift({value:l,label:"无二级分类",children:null})}a.push(t)})),a},f=e=>{a("input",e)};return l({getProductCategories:p,kinds:r}),(l,a)=>{const u=(0,t.up)("el-cascader");return(0,t.wg)(),(0,t.j4)(u,{placeholder:"请选择分类",options:c.value,clearable:"",value:e.value,filterable:"",props:m.value,onChange:f},null,8,["options","value","props"])}}};const n=s;var r=n}}]);