"use strict";(self["webpackChunkbk_pc"]=self["webpackChunkbk_pc"]||[]).push([[2450],{52450:function(e,l,a){a.r(l),a.d(l,{default:function(){return L}});a(21703),a(57658);var t=a(73396),u=a(44870),o=a(87139),d=a(55743),i=a.n(d),r=a(22483),s=a(40130),n=a(47178),m=a(60814),c=a(61073),p=a(44161),v=a(72748);const f=e=>((0,t.dD)("data-v-0e9dfc8a"),e=e(),(0,t.Cn)(),e),g={class:"commodity-library"},w={class:"select-wrapper"},y={style:{padding:"5px"}},_={style:{padding:"5px"}},h={class:"my-20"},b={class:"result"},k=f((()=>(0,t._)("div",{class:"font-14"},"查询结果",-1))),W={style:{"max-height":"200px",overflow:"auto"}},V={class:"flex justify-between"},U={class:"flex justify-center mt-40"},x={key:0},T=f((()=>(0,t._)("div",{class:"font-16"},"店铺信息",-1))),D={class:"flex"},C={class:"flex-1 message-info"},j=f((()=>(0,t._)("div",{class:"logo flex justify-center items-center"},"logo",-1))),S={class:"user-comment"},I=f((()=>(0,t._)("div",{class:"mb-20 font-16"},"用户评价",-1))),Y={class:"comment-content"},$={key:0,class:"comment-img-wrapper"},q=["onClick"],z={class:"el-upload-list__item-preview"},O={class:"flex justify-between"},N={class:"flex justify-end"},G={style:{color:"#333"}},H={class:"dialog-footer"},Z=["src"];var E={__name:"MemberComments",setup(e){const l=(0,r.tv)(),a=(0,r.yj)(),d=a.query.id,f=(0,u.ref)([{value:"",label:"全部"},{value:"1",label:"好评"},{value:"2",label:"全部"},{value:"3",label:"差评"}]),E=(0,u.ref)([{value:"",label:"全部"},{value:"1",label:"正式账号"},{value:"2",label:"演示账号"}]),F=(0,u.ref)({user:"",accountType:"",evaluationType:""}),M=e=>{},L=(0,u.ref)(!1),K=()=>{},P=()=>{Object.keys(F.value).forEach((e=>{F.value[e]=""}))},R=(0,u.ref)(1),B=(0,u.ref)(10),Q=(0,u.ref)(0),A=(0,u.ref)([]),J=(0,u.ref)(!1),X=()=>{J.value=!0;const e={systemGoodsId:d,username:F.value.user,accountType:F.value.accountType,evaluationType:F.value.evaluationType,pageNo:R.value,pageSize:B.value};(0,p.Z)({method:"get",url:`${c.O9}/systemGoods/evaluation/list.action`,params:e}).then((e=>{J.value=!1,A.value=e.data.data.elements,A.value.forEach((e=>{})),R.value=e.data.data.thisPageNumber,B.value=e.data.data.pageSize,Q.value=e.data.data.totalElements}))};X();const ee=()=>{X()},le=(0,u.ref)(!1),ae=()=>{X()},te=e=>{s.T.confirm("你确定要删除吗?","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{ue(e).then((e=>{(0,n.z8)({type:"success",message:"删除成功"})})),X()})).catch((()=>{(0,n.z8)({type:"info",message:"取消删除"})}))},ue=e=>(0,p.Z)({method:"post",url:`${c.O9}/systemGoods/evaluation/hide.action?id=${e}`}),oe=(0,u.ref)(null),de=(0,u.ref)(!1),ie=(0,u.ref)({sellerId:"",fromTime:"",toTime:""}),re=(0,u.reactive)({sellerId:[{required:!0,message:"请选择店铺",trigger:"blur"}],fromTime:[{required:!0,message:"请选择开始时间",trigger:"blur"}],toTime:[{required:!0,message:"请选择开始时间",trigger:"blur"}]}),se=()=>{if(i()(ie.value.fromTime).unix()>i()(ie.value.toTime).unix())return(0,n.z8)({message:"开始时间不能大于结束时间！",type:"error"}),ie.value.fromTime="",void(ie.value.toTime="");const e=new FormData;Object.keys(ie.value).forEach((l=>{e.append(l,ie.value[l])})),(0,p.Z)({method:"post",url:`${c.O9}/systemGoods/evaluation/changeTime.action?`,data:e}).then((e=>{0==e.data.code&&(0,n.z8)({message:"修改成功",type:"success"}),de.value=!1,Object.keys(ie.value).forEach((e=>{ie.value[e]=""})),X()}))},ne=(0,u.ref)(!1),me=(0,u.ref)(null),ce=(0,u.reactive)({userName:"",rating:"",sellerId:"",content:"",sellerGoodsId:""}),pe=(e,l,a)=>{l/1>5||l/1<1||-1!==l.indexOf(".")?a(new Error("请输入1-5分, 不能有小数")):a()},ve=(0,u.reactive)({rating:[{required:!0,validator:pe,trigger:"blur"}],content:[{required:!0,message:"请输入评论内容",trigger:"change"}],userName:[{required:!0,type:"date",message:"请输入用户账号",trigger:"change"}],sellerId:[{type:"date",required:!0,message:"请输入商品所属商户id",trigger:"blur"}],sellerGoodsId:[{type:"date",required:!0,message:"请输入商品id",trigger:"blur"}]}),fe=async(e,l)=>{e&&(await e.validate(((e,l)=>{})),"change"===l&&se())},ge=(e,l)=>{"change"===l?de.value=!1:"add"===l&&(ne.value=!1),we(e)},we=e=>{e&&e.resetFields()},ye=async(e,l)=>{let a;J.value=!0,l?(await _e(e),a=1):(await he(e),a=0),J.value=!1;const t=A.value.findIndex((l=>l.id===e));A.value[t].status=a,(0,n.z8)({message:"修改成功",type:"success"})},_e=e=>{const l=new FormData;return l.append("id",e),(0,p.Z)({method:"post",url:`${c.O9}/systemGoods/evaluation/hide.action`,data:l})},he=e=>{const l=new FormData;return l.append("id",e),(0,p.Z)({method:"post",url:`${c.O9}/systemGoods/evaluation/open.action`,data:l})},be=(0,u.ref)({}),ke=e=>{e.imgList=[],Object.keys(e).forEach((l=>{-1!==l.indexOf("imgUrl")&&e[l]&&e.imgList.push(e[l])})),L.value=!0,be.value=e},We=(0,u.ref)(""),Ve=(0,u.ref)(!1),Ue=e=>{We.value=e,Ve.value=!0},xe=(0,u.ref)([]),Te=(0,u.ref)([]),De=()=>{(0,p.Z)({method:"post",url:`${c.vS}/api/item/findSellerList`}).then((function(e){xe.value=e.data.data,Te.value=xe.value}))};return De(),(e,a)=>{const d=(0,t.up)("el-button"),i=(0,t.up)("el-input"),r=(0,t.up)("el-form-item"),s=(0,t.up)("el-option"),n=(0,t.up)("el-select"),c=(0,t.up)("el-form"),p=(0,t.up)("el-table-column"),X=(0,t.up)("el-tag"),ue=(0,t.up)("el-switch"),se=(0,t.up)("el-table"),pe=(0,t.up)("el-pagination"),we=(0,t.up)("el-config-provider"),_e=(0,t.up)("el-icon"),he=(0,t.up)("el-image"),xe=(0,t.up)("el-dialog"),De=(0,t.up)("el-date-picker"),Ce=(0,t.Q2)("loading");return(0,t.wg)(),(0,t.iD)(t.HY,null,[(0,t._)("div",g,[(0,t.Wm)(d,{style:{"margin-bottom":"10px"},type:"primary",onClick:a[0]||(a[0]=e=>(0,u.unref)(l).go(-1))},{default:(0,t.w5)((()=>[(0,t.Uk)("返回")])),_:1}),(0,t._)("div",w,[(0,t.Wm)(c,{class:"flex mt-10","label-width":"120px"},{default:(0,t.w5)((()=>[(0,t.Wm)(r,{label:"会员账号："},{default:(0,t.w5)((()=>[(0,t.Wm)(i,{modelValue:F.value.user,"onUpdate:modelValue":a[1]||(a[1]=e=>F.value.user=e),placeholder:"会员账号"},null,8,["modelValue"])])),_:1}),(0,t.Wm)(r,{label:"账号类型："},{default:(0,t.w5)((()=>[(0,t.Wm)(n,{modelValue:F.value.accountType,"onUpdate:modelValue":a[2]||(a[2]=e=>F.value.accountType=e),class:"m-2",placeholder:"账号类型"},{default:(0,t.w5)((()=>[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(E.value,(e=>((0,t.wg)(),(0,t.j4)(s,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),(0,t.Wm)(r,{label:"评分："},{default:(0,t.w5)((()=>[(0,t.Wm)(n,{modelValue:F.value.evaluationType,"onUpdate:modelValue":a[3]||(a[3]=e=>F.value.evaluationType=e),class:"m-2",placeholder:"评价"},{default:(0,t.w5)((()=>[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(f.value,(e=>((0,t.wg)(),(0,t.j4)(s,{key:e.label,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),(0,t.Wm)(r,null,{default:(0,t.w5)((()=>[(0,t._)("div",y,[(0,t.Wm)(d,{type:"primary",onClick:ae,loading:le.value},{default:(0,t.w5)((()=>[(0,t.Uk)("查询")])),_:1},8,["loading"])]),(0,t._)("div",_,[(0,t.Wm)(d,{type:"primary",onClick:P},{default:(0,t.w5)((()=>[(0,t.Uk)("重置")])),_:1})])])),_:1})])),_:1})]),(0,t._)("div",h,[(0,t.Wm)(d,{class:"mr-15",type:"primary",onClick:a[4]||(a[4]=e=>de.value=!0)},{default:(0,t.w5)((()=>[(0,t.Uk)("一键修改评论时间")])),_:1})]),(0,t._)("div",b,[k,(0,t.wy)(((0,t.wg)(),(0,t.j4)(se,{class:"mt-15",onSelectionChange:M,data:A.value,border:"",style:{width:"100%"}},{default:(0,t.w5)((()=>[(0,t.Wm)(p,{type:"selection",width:"55"}),(0,t.Wm)(p,{prop:"userName",label:"会员账号",width:"260"}),(0,t.Wm)(p,{label:"账号类型",width:"100"},{default:(0,t.w5)((e=>[e.row.accountType/1===1?((0,t.wg)(),(0,t.j4)(X,{key:0},{default:(0,t.w5)((()=>[(0,t.Uk)("正式账号")])),_:1})):(0,t.kq)("",!0),e.row.accountType/1===2?((0,t.wg)(),(0,t.j4)(X,{key:1,type:"warning"},{default:(0,t.w5)((()=>[(0,t.Uk)("演示账号")])),_:1})):(0,t.kq)("",!0)])),_:1}),(0,t.Wm)(p,{label:"评价",width:"80"},{default:(0,t.w5)((e=>[e.row.evaluationType/1===1?((0,t.wg)(),(0,t.j4)(X,{key:0},{default:(0,t.w5)((()=>[(0,t.Uk)("好评")])),_:1})):e.row.evaluationType/1===2?((0,t.wg)(),(0,t.j4)(X,{key:1,type:"warning"},{default:(0,t.w5)((()=>[(0,t.Uk)("中评")])),_:1})):((0,t.wg)(),(0,t.j4)(X,{key:2,type:"danger"},{default:(0,t.w5)((()=>[(0,t.Uk)("差评")])),_:1}))])),_:1}),(0,t.Wm)(p,{prop:"rating",label:"评分",width:"80"}),(0,t.Wm)(p,{prop:"sellerName",label:"所在店铺"}),(0,t.Wm)(p,{label:"评价内容","min-width":"600"},{default:(0,t.w5)((e=>[(0,t._)("div",W,(0,o.toDisplayString)(e.row.content),1)])),_:1}),(0,t.Wm)(p,{label:"评价时间",width:"180"},{default:(0,t.w5)((e=>[(0,t.Uk)((0,o.toDisplayString)(e.row.commentTime),1)])),_:1}),(0,t.Wm)(p,{label:"前端展示",width:"100"},{default:(0,t.w5)((e=>[(0,t.Wm)(ue,{modelValue:e.row.status,"onUpdate:modelValue":l=>e.row.status=l,"active-value":0,"inactive-value":1,onChange:l=>ye(e.row.id,l)},null,8,["modelValue","onUpdate:modelValue","onChange"])])),_:1}),(0,t.Wm)(p,{label:"操作",width:"180"},{default:(0,t.w5)((e=>[(0,t._)("div",V,[(0,t.Wm)(d,{onClick:l=>ke(e.row)},{default:(0,t.w5)((()=>[(0,t.Uk)("查看评价")])),_:2},1032,["onClick"]),(0,t.Wm)(d,{type:"danger",onClick:l=>te(e.row.id)},{default:(0,t.w5)((()=>[(0,t.Uk)("删除")])),_:2},1032,["onClick"])])])),_:1})])),_:1},8,["data"])),[[Ce,J.value]])]),(0,t._)("div",U,[(0,t.Wm)(we,{locale:(0,u.unref)(m.Z)},{default:(0,t.w5)((()=>[(0,t.Wm)(pe,{"current-page":R.value,"onUpdate:currentPage":a[5]||(a[5]=e=>R.value=e),"page-size":B.value,"onUpdate:pageSize":a[6]||(a[6]=e=>B.value=e),"page-sizes":[10,20,30,50],background:"",layout:"total, prev, pager, next",total:Q.value,onCurrentChange:ee},null,8,["current-page","page-size","total"])])),_:1},8,["locale"])])]),(0,t.Wm)(xe,{"show-close":!1,modelValue:L.value,"onUpdate:modelValue":a[11]||(a[11]=e=>L.value=e),title:"用户评价详情",width:"40%","before-close":K},{footer:(0,t.w5)((()=>[(0,t._)("div",O,[(0,t.Wm)(r,{label:"前端展示："},{default:(0,t.w5)((()=>[(0,t.Wm)(ue,{modelValue:be.value.status,"onUpdate:modelValue":a[7]||(a[7]=e=>be.value.status=e),"active-value":0,"inactive-value":1,onChange:a[8]||(a[8]=e=>ye(be.value.id,be.value.status))},null,8,["modelValue"])])),_:1}),(0,t._)("div",null,[(0,t.Wm)(d,{type:"primary",onClick:a[9]||(a[9]=e=>L.value=!1)},{default:(0,t.w5)((()=>[(0,t.Uk)((0,o.toDisplayString)(e.$t("确定")),1)])),_:1}),(0,t.Wm)(d,{style:{"margin-left":"12px"},onClick:a[10]||(a[10]=e=>L.value=!1)},{default:(0,t.w5)((()=>[(0,t.Uk)((0,o.toDisplayString)(e.$t("取消")),1)])),_:1})])])])),default:(0,t.w5)((()=>[Object.keys(be.value).length>0?((0,t.wg)(),(0,t.iD)("div",x,[T,(0,t._)("div",D,[(0,t._)("div",C,[(0,t._)("div",null,"店铺名称："+(0,o.toDisplayString)(be.value.sellerName),1),(0,t._)("div",null,"订单标号："+(0,o.toDisplayString)(be.value.orderId),1),(0,t._)("div",null,"商品名称："+(0,o.toDisplayString)(be.value.goodsVo.name),1)]),j])])):(0,t.kq)("",!0),(0,t._)("div",S,[I,(0,t._)("div",null,(0,o.toDisplayString)(be.value.userName),1),(0,t._)("div",Y,(0,o.toDisplayString)(be.value.content||"无"),1),be.value.imgList.length>0?((0,t.wg)(),(0,t.iD)("div",$,[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(be.value.imgList,(e=>((0,t.wg)(),(0,t.iD)("div",{class:"img-wrapper",key:e},[(0,t._)("div",{class:"view",onClick:l=>Ue(e)},[(0,t._)("span",z,[(0,t.Wm)(_e,{style:{"font-size":"26px"}},{default:(0,t.w5)((()=>[(0,t.Wm)((0,u.unref)(v.DYM),{style:{color:"#fff"}})])),_:1})])],8,q),(0,t.Wm)(he,{src:e,fit:"cover"},null,8,["src"])])))),128))])):(0,t.kq)("",!0)])])),_:1},8,["modelValue"]),(0,t.Wm)(xe,{"show-close":!1,modelValue:de.value,"onUpdate:modelValue":a[17]||(a[17]=e=>de.value=e),title:"一键修改评论时间",width:"30%"},{footer:(0,t.w5)((()=>[(0,t._)("div",N,[(0,t.Wm)(d,{type:"primary",onClick:a[15]||(a[15]=e=>fe(oe.value,"change"))},{default:(0,t.w5)((()=>[(0,t.Uk)((0,o.toDisplayString)(e.$t("确定")),1)])),_:1}),(0,t.Wm)(d,{style:{"margin-left":"12px"},onClick:a[16]||(a[16]=e=>ge(oe.value,"change"))},{default:(0,t.w5)((()=>[(0,t.Uk)((0,o.toDisplayString)(e.$t("取消")),1)])),_:1})])])),default:(0,t.w5)((()=>[(0,t.Wm)(c,{model:ie.value,rules:re,ref_key:"changeTimeForm",ref:oe},{default:(0,t.w5)((()=>[(0,t.Wm)(r,{label:"选择店铺"},{default:(0,t.w5)((()=>[(0,t.Wm)(n,{modelValue:ie.value.sellerId,"onUpdate:modelValue":a[12]||(a[12]=e=>ie.value.sellerId=e),filterable:"",class:"flex-1",placeholder:"请选择店铺"},{default:(0,t.w5)((()=>[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(Te.value,(e=>((0,t.wg)(),(0,t.j4)(s,{key:e.sellerId,label:e.sellerName,value:e.sellerId},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),(0,t.Wm)(r,{label:"开始时间"},{default:(0,t.w5)((()=>[(0,t.Wm)(De,{class:"flex-1",modelValue:ie.value.fromTime,"onUpdate:modelValue":a[13]||(a[13]=e=>ie.value.fromTime=e),type:"datetime","value-format":"YYYY-MM-DD HH:mm:ss",placeholder:"选择开始时间"},null,8,["modelValue"])])),_:1}),(0,t.Wm)(r,{label:"结束时间"},{default:(0,t.w5)((()=>[(0,t.Wm)(De,{class:"flex-1",modelValue:ie.value.toTime,"onUpdate:modelValue":a[14]||(a[14]=e=>ie.value.toTime=e),type:"datetime","value-format":"YYYY-MM-DD HH:mm:ss",placeholder:"选择结束时间"},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["modelValue"]),(0,t.Wm)(xe,{"show-close":!1,modelValue:ne.value,"onUpdate:modelValue":a[22]||(a[22]=e=>ne.value=e),title:"新增评论",width:"40%"},{footer:(0,t.w5)((()=>[(0,t._)("span",H,[(0,t.Wm)(d,{type:"primary",onClick:a[20]||(a[20]=e=>fe(me.value,"add"))},{default:(0,t.w5)((()=>[(0,t.Uk)((0,o.toDisplayString)(e.$t("确定")),1)])),_:1}),(0,t.Wm)(d,{style:{"margin-left":"12px"},onClick:a[21]||(a[21]=e=>ge(me.value,"add"))},{default:(0,t.w5)((()=>[(0,t.Uk)((0,o.toDisplayString)(e.$t("取消")),1)])),_:1})])])),default:(0,t.w5)((()=>[(0,t.Wm)(c,{ref_key:"ruleFormRef",ref:me,model:ce,rules:ve,"label-width":"140"},{default:(0,t.w5)((()=>[(0,t.Wm)(r,{class:"img-upload",label:"用户账号",prop:"content"},{default:(0,t.w5)((()=>[(0,t.Wm)(i,{disabled:"","model-value":ce.userName,placeholder:"用户账号"},null,8,["model-value"])])),_:1}),(0,t.Wm)(r,{class:"img-upload",label:"`评分",prop:"rating"},{default:(0,t.w5)((()=>[(0,t.Wm)(i,{type:"number",modelValue:ce.rating,"onUpdate:modelValue":a[18]||(a[18]=e=>ce.rating=e),placeholder:"请输入1-5分",min:"1",max:"5"},{suffix:(0,t.w5)((()=>[(0,t._)("span",G,(0,o.toDisplayString)(e.$t("分")),1)])),_:1},8,["modelValue"])])),_:1}),(0,t.Wm)(r,{class:"img-upload",label:"商品所属商户id",prop:"score"},{default:(0,t.w5)((()=>[(0,t.Wm)(i,{disabled:"","model-value":ce.sellerId,placeholder:"商品所属商户id"},null,8,["model-value"])])),_:1}),(0,t.Wm)(r,{class:"img-upload",label:"商品id",prop:"score"},{default:(0,t.w5)((()=>[(0,t.Wm)(i,{disabled:"","model-value":ce.sellerGoodsId,placeholder:"商品id"},null,8,["model-value"])])),_:1}),(0,t.Wm)(r,{class:"img-upload",label:"评价内容",prop:"content"},{default:(0,t.w5)((()=>[(0,t.Wm)(i,{modelValue:ce.content,"onUpdate:modelValue":a[19]||(a[19]=e=>ce.content=e),autosize:{minRows:2,maxRows:4},type:"textarea",placeholder:"评价内容"},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["modelValue"]),(0,t.Wm)(xe,{modelValue:Ve.value,"onUpdate:modelValue":a[23]||(a[23]=e=>Ve.value=e),width:"30%"},{default:(0,t.w5)((()=>[(0,t._)("img",{style:{width:"100%"},src:We.value,alt:"Preview Image"},null,8,Z)])),_:1},8,["modelValue"])],64)}}},F=a(40089);const M=(0,F.Z)(E,[["__scopeId","data-v-0e9dfc8a"]]);var L=M}}]);