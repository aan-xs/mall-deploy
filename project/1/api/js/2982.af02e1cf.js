"use strict";(self["webpackChunkshop"]=self["webpackChunkshop"]||[]).push([[2982],{81388:function(t,e,s){s.d(e,{Z:function(){return E}});var i,n=s(11084),o=s(65988),l=s(60231),a=s.n(l),c=s(94868),r=s(71149),h=s(26870),d=s(58867),u=s(64798),m=s(42310),f=s(47179),g=(0,c.d)("goods-action"),p=g[0],v=g[1],k=p({mixins:[(0,f.G)("vanGoodsAction")],props:{safeAreaInsetBottom:{type:Boolean,default:!0}},render:function(){var t=arguments[0];return t("div",{class:v({unfit:!this.safeAreaInsetBottom})},[this.slots()])}}),C=s(68212),y=(0,c.d)("goods-action-button"),b=y[0],_=y[1],x=b({mixins:[(0,f.j)("vanGoodsAction")],props:(0,n.Z)({},C.g2,{type:String,text:String,icon:String,color:String,loading:Boolean,disabled:Boolean}),computed:{isFirst:function(){var t=this.parent&&this.parent.children[this.index-1];return!t||t.$options.name!==this.$options.name},isLast:function(){var t=this.parent&&this.parent.children[this.index+1];return!t||t.$options.name!==this.$options.name}},methods:{onClick:function(t){this.$emit("click",t),(0,C.BC)(this.$router,this)}},render:function(){var t=arguments[0];return t(m.Z,{class:_([{first:this.isFirst,last:this.isLast},this.type]),attrs:{size:"large",type:this.type,icon:this.icon,color:this.color,loading:this.loading,disabled:this.disabled},on:{click:this.onClick}},[this.slots()||this.text])}}),$=(0,c.d)("dialog"),A=$[0],I=$[1],B=$[2],w=A({mixins:[(0,u.e)()],props:{title:String,theme:String,width:[Number,String],message:String,className:null,callback:Function,beforeClose:Function,messageAlign:String,cancelButtonText:String,cancelButtonColor:String,confirmButtonText:String,confirmButtonColor:String,showCancelButton:Boolean,overlay:{type:Boolean,default:!0},allowHtml:{type:Boolean,default:!0},transition:{type:String,default:"van-dialog-bounce"},showConfirmButton:{type:Boolean,default:!0},closeOnPopstate:{type:Boolean,default:!0},closeOnClickOverlay:{type:Boolean,default:!1}},data:function(){return{loading:{confirm:!1,cancel:!1}}},methods:{onClickOverlay:function(){this.handleAction("overlay")},handleAction:function(t){var e=this;this.$emit(t),this.value&&(this.beforeClose?(this.loading[t]=!0,this.beforeClose(t,(function(s){!1!==s&&e.loading[t]&&e.onClose(t),e.loading.confirm=!1,e.loading.cancel=!1}))):this.onClose(t))},onClose:function(t){this.close(),this.callback&&this.callback(t)},onOpened:function(){var t=this;this.$emit("opened"),this.$nextTick((function(){var e;null==(e=t.$refs.dialog)||e.focus()}))},onClosed:function(){this.$emit("closed")},onKeydown:function(t){var e=this;if("Escape"===t.key||"Enter"===t.key){if(t.target!==this.$refs.dialog)return;var s={Enter:this.showConfirmButton?function(){return e.handleAction("confirm")}:r.ZT,Escape:this.showCancelButton?function(){return e.handleAction("cancel")}:r.ZT};s[t.key](),this.$emit("keydown",t)}},genRoundButtons:function(){var t=this,e=this.$createElement;return e(k,{class:I("footer")},[this.showCancelButton&&e(x,{attrs:{size:"large",type:"warning",text:this.cancelButtonText||B("cancel"),color:this.cancelButtonColor,loading:this.loading.cancel},class:I("cancel"),on:{click:function(){t.handleAction("cancel")}}}),this.showConfirmButton&&e(x,{attrs:{size:"large",type:"danger",text:this.confirmButtonText||B("confirm"),color:this.confirmButtonColor,loading:this.loading.confirm},class:I("confirm"),on:{click:function(){t.handleAction("confirm")}}})])},genButtons:function(){var t,e=this,s=this.$createElement,i=this.showCancelButton&&this.showConfirmButton;return s("div",{class:[d.k7,I("footer")]},[this.showCancelButton&&s(m.Z,{attrs:{size:"large",loading:this.loading.cancel,text:this.cancelButtonText||B("cancel"),nativeType:"button"},class:I("cancel"),style:{color:this.cancelButtonColor},on:{click:function(){e.handleAction("cancel")}}}),this.showConfirmButton&&s(m.Z,{attrs:{size:"large",loading:this.loading.confirm,text:this.confirmButtonText||B("confirm"),nativeType:"button"},class:[I("confirm"),(t={},t[d.a8]=i,t)],style:{color:this.confirmButtonColor},on:{click:function(){e.handleAction("confirm")}}})])},genContent:function(t,e){var s=this.$createElement;if(e)return s("div",{class:I("content")},[e]);var i=this.message,n=this.messageAlign;if(i){var o,l,c={class:I("message",(o={"has-title":t},o[n]=n,o)),domProps:(l={},l[this.allowHtml?"innerHTML":"textContent"]=i,l)};return s("div",{class:I("content",{isolated:!t})},[s("div",a()([{},c]))])}}},render:function(){var t=arguments[0];if(this.shouldRender){var e=this.message,s=this.slots(),i=this.slots("title")||this.title,n=i&&t("div",{class:I("header",{isolated:!e&&!s})},[i]);return t("transition",{attrs:{name:this.transition},on:{afterEnter:this.onOpened,afterLeave:this.onClosed}},[t("div",{directives:[{name:"show",value:this.value}],attrs:{role:"dialog","aria-labelledby":this.title||e,tabIndex:0},class:[I([this.theme]),this.className],style:{width:(0,h.N)(this.width)},ref:"dialog",on:{keydown:this.onKeydown}},[n,this.genContent(i,s),"round-button"===this.theme?this.genRoundButtons():this.genButtons()])])}}});function T(t){return document.body.contains(t)}function N(){i&&i.$destroy(),i=new(o["default"].extend(w))({el:document.createElement("div"),propsData:{lazyRender:!1}}),i.$on("input",(function(t){i.value=t}))}function S(t){return r.sk?Promise.resolve():new Promise((function(e,s){i&&T(i.$el)||N(),(0,n.Z)(i,S.currentOptions,t,{resolve:e,reject:s})}))}S.defaultOptions={value:!0,title:"",width:"",theme:null,message:"",overlay:!0,className:"",allowHtml:!0,lockScroll:!0,transition:"van-dialog-bounce",beforeClose:null,overlayClass:"",overlayStyle:null,messageAlign:"",getContainer:"body",cancelButtonText:"",cancelButtonColor:null,confirmButtonText:"",confirmButtonColor:null,showConfirmButton:!0,showCancelButton:!1,closeOnPopstate:!0,closeOnClickOverlay:!1,callback:function(t){i["confirm"===t?"resolve":"reject"](t)}},S.alert=S,S.confirm=function(t){return S((0,n.Z)({showCancelButton:!0},t))},S.close=function(){i&&(i.value=!1)},S.setDefaultOptions=function(t){(0,n.Z)(S.currentOptions,t)},S.resetDefaultOptions=function(){S.currentOptions=(0,n.Z)({},S.defaultOptions)},S.resetDefaultOptions(),S.install=function(){o["default"].use(w)},S.Component=w,o["default"].prototype.$dialog=S;var E=S},2605:function(t,e,s){s(95812),s(43883),s(57846),s(35726),s(19591),s(64733),s(15724)},81202:function(t,e,s){s.r(e),s.d(e,{default:function(){return y}});var i=function(){var t=this,e=t._self._c;return e("div",{staticClass:"mall"},[e("van-nav-bar",{class:t.isChristmas&&"christmas-nav-bar",attrs:{"safe-area-inset-top":"",fixed:"",title:t.$t("购物车")}}),e("div",{staticStyle:{width:"100%",height:"46px"}}),t.list.length>0?[t._l(t.list,(function(i,n){return e("div",{key:i.key,staticClass:"mall-detail"},[e("van-checkbox",{staticClass:"mall-title",on:{click:function(e){return t.handleCheckItemAll(i.checkedAll,n)}},model:{value:i.checkedAll,callback:function(e){t.$set(i,"checkedAll",e)},expression:"item.checkedAll"}},[t._v(t._s(i.sort))]),e("div",{staticClass:"mall-item"},[e("van-checkbox-group",{on:{change:t.mathMoney},model:{value:i.checkedValue,callback:function(e){t.$set(i,"checkedValue",e)},expression:"item.checkedValue"}},[t._l(i.child,(function(s,o){return[o<i.moreNum?e("van-checkbox",{key:o,staticClass:"mall-item-checkbox",class:0==s.isShelf&&"shelves_item",attrs:{name:s.tempId},on:{click:function(e){return t.handlecheckItemClick(i,n,o)}},model:{value:s.selected,callback:function(e){t.$set(s,"selected",e)},expression:"i.selected"}},[0==s.isShelf?e("div",{staticClass:"shelves_text"},[t._v(" "+t._s(t.$t("已下架"))+" ")]):t._e(),e("div",{staticClass:"mall-item-child",on:{touchstart:function(e){return t.handlerTouchstart(n,o,s)},touchmove:t.handleClearInterval,touchend:t.handleClearInterval}},[e("div",{staticClass:"mall-item-child-img"},[e("img",{staticClass:"img",attrs:{src:s.coverImg||s.img}})]),e("div",{staticStyle:{width:"75%","margin-left":"6px"}},[e("p",{staticClass:"describe"},[t._v(" "+t._s(s.describe?.length>43?s.describe.slice(0,43)+"...":s.describe)+" ")]),s.attributes?e("p",{staticClass:"sku_box"},t._l(s.attributes,(function(s,i){return e("span",{key:i,staticClass:"attribute"},[t._v(" "+t._s(s.attrName)+":"+t._s(s.attrValue))])})),0):t._e(),e("div",{staticClass:"price"},[e("span",[t._v(" $ "+t._s(t.priceFormat(s.price))+" ")]),e("div",{staticClass:"stepper",on:{click:function(e){return e.stopPropagation(),t.mathMoney.apply(null,arguments)}}},[e("van-stepper",{attrs:{disabled:0==i.checkedValue.length,max:t.maxBuyNum,integer:""},on:{change:t.mathMoney,plus:function(e){return t.handleStepper("add",s)},minus:function(e){return t.handleStepper("minus",s)}},model:{value:s.count,callback:function(e){t.$set(s,"count",e)},expression:"i.count"}})],1)])])])]):t._e()]})),e("div",{directives:[{name:"show",rawName:"v-show",value:i.child.length>1&&i.moreNum<i.child.length,expression:"item.child.length > 1 && item.moreNum < item.child.length\n                        "}],staticClass:"show-more",on:{click:function(t){i.moreNum+=2}}},[e("p",[t._v(t._s(t.$t("查看更多")))]),e("img",{attrs:{src:s(48457)}})])],2)],1)],1)})),e("div",{staticClass:"mall-bottom"},[t.isNewLine?t._e():e("van-checkbox",{staticClass:"checkbox_cn",on:{click:t.handleCheckAll},model:{value:t.checkedAllTotol,callback:function(e){t.checkedAllTotol=e},expression:"checkedAllTotol"}},[t._v(" "+t._s(t.$t("全选"))+" ")]),e("div",{staticClass:"mid"},[t.isNewLine?e("van-checkbox",{staticClass:"checkbox",on:{click:t.handleCheckAll},model:{value:t.checkedAllTotol,callback:function(e){t.checkedAllTotol=e},expression:"checkedAllTotol"}},[t._v(" "+t._s(t.$t("全选"))+" ")]):t._e(),e("span",[t._v(t._s(t.$t("总计"))+" "),e("span",{staticClass:"price"},[t._v("$"+t._s(t.priceFormat(t.total.money)))])]),e("span",[t._v(t._s(t.$t("选择"))+" "),e("span",{staticClass:"piece"},[t._v(t._s(t.total.piece))]),t._v(" "+t._s(t.$t("个")))])],1),e("van-button",{staticClass:"pay-btn",staticStyle:{"margin-right":"10px"},attrs:{color:"rgba(233, 157, 56, 1)"},on:{click:t.toBuy}},[t._v(" "+t._s(t.$t("立即购买"))+" ")])],1)]:e("div",{staticClass:"mall-empty"},[e("img",{staticClass:"img",attrs:{src:s(907)}}),e("p",{staticClass:"text"},[t._v(t._s(t.$t("购物车空空")))]),e("router-link",{attrs:{to:"/commodity"}},[e("van-button",{staticClass:"button",attrs:{color:"rgba(233, 157, 56, 1)"}},[t._v(t._s(t.$t("立即购物")))])],1)],1),e("div",{staticStyle:{width:"100%",height:"118px"}}),t._l(50,(function(s){return t.isChristmas?e("div",{key:s,staticClass:"snowflake"}):t._e()}))],2)},n=[],o=(s(43635),s(93407)),l=(s(2605),s(81388)),a=(s(22790),s(34684)),c=(s(40752),s(88969)),r=(s(2710),s(42418)),h=(s(68529),s(53667)),d=(s(25280),s(80607)),u=(s(73927),s(22745)),m=s(90021),f=s(65988),g=s(17223),p={setup(){const t=(0,f.ref)(["a","b"]),e=(0,f.ref)(!1),s=(0,f.ref)(!0),i=(0,f.ref)(null),n=()=>{i.value.toggleAll(!0)};return{checked:t,checkedAll:e,checkAll:n,checkedAllTotol:s,checkboxGroup:i}},data(){return{priceFormat:g.XY,refreshing:!1,loop:0,list:[],total:{},lang:(0,g.cF)("lang"),isNewLine:["it","de","ms","pt","es","ru","el","tr","fr"].includes((0,g.cF)("lang")),maxBuyNum:localStorage.getItem("maxBuyNum")||500,pageNum:1,isChristmas:{NODE_ENV:"production",VUE_APP_FOOTER_COLOR:"#f89900",VUE_APP_ITEM_NAME:"SM-wholesaleShop",VUE_APP_MAIN_COLOR:"#f89900",BASE_URL:"./"}?.VUE_APP_IS_CHRISTMAS}},components:{[d.Z.name]:d.Z,[h.Z.name]:h.Z,[r.Z.name]:r.Z,[c.Z.name]:c.Z,[a.Z.name]:a.Z,[l.Z.Component.name]:l.Z.Component},created(){(0,g.bg)()&&this.getCartlist(),this.mathMoney()},methods:{handlerTouchstart(t,e,s){let{id:i,skuId:n,count:o}=s,a=this.$ls.get("productList")||[];this.loop=setTimeout((()=>{this.loop=0,l.Z.confirm({title:this.$t("提示"),message:this.$t("确认移除商品吗?"),confirmButtonText:this.$t("确认"),cancelButtonText:this.$t("取消")}).then((async()=>{this.$toast.loading(),await(0,u.NP)({skuId:n,sellerGoodsId:i,buyNum:o,isMove:1}),this.$toast.clear(),this.$store.state.qiangdan.count=a.length,this.$ls.set("productList",a),this.list=[],this.pageNum=1,this.getCartlist()}))}),500)},handleClearInterval(){clearTimeout(this.loop),this.loop=0},async handleStepper(t,e){let s=this.total.piece;"add"==t?s+=1:s-=1,this.$store.state.qiangdan.count=s,await(0,u.NP)({skuId:e.skuId,sellerGoodsId:e.id,buyNum:e.count+("add"==t?1:-1)})},mathMoney(){let t=this.$ls.get("productList")||[];this.total={money:0,piece:0},this.list.forEach((e=>{this.total.piece=this.total.piece+=e.checkedValue.length,e.child.length>0&&e.child.forEach((s=>{t.forEach((t=>{t.id==s.id&&(t.count=s.count)})),e.checkedValue.includes(s.tempId)&&(this.total.money+=s.price.toFixed(2)*s.count)}))})),this.total.money=this.total.money.toFixed(2),this.$ls.set("productList",t)},async getCartlist(){const{pageList:t,pageInfo:e}=await(0,u.AY)({pageNum:this.pageNum,pageSize:20});localStorage.setItem("CART_NUM",e.totalElements),this.$store.state.qiangdan.count=e.totalElements;let s=t||[];if(s&&s.length>0){s.forEach((t=>{if(this.list.length>0)this.list.forEach((e=>{let s=[];if(t.attributes&&(s=t.attributes),e.sort==t.sellerName){let s=[];t.attributes&&(s=t.attributes);let i={coverImg:t.goodsIcon,skuId:t.skuId,img:t.imgUrl1||this.$defaultGoodsImage,price:t.discountPrice?t.discountPrice:t.sellingPrice,describe:t.goodsName,count:t.goodsNum,id:`${t.goodsId}`,tempId:t.tempId,attributes:s,freightAmount:t.freightAmount||0,goodsTax:t.goodsTax||0,selected:!0,isShelf:t.isShelf};e.child.unshift(i)}else{let e={key:t.sellerId,sort:t.sellerName,checkedAll:!0,checkedValue:[],moreNum:2,child:[]},i={coverImg:t.goodsIcon,skuId:t.skuId,img:t.imgUrl1||this.$defaultGoodsImage,price:t.discountPrice?t.discountPrice:t.sellingPrice,describe:t.goodsName,count:t.goodsNum,id:`${t.goodsId}`,tempId:t.tempId,freightAmount:t.freightAmount||0,goodsTax:t.goodsTax||0,selected:!0,isShelf:t.isShelf,attributes:s};e.child.unshift(i),this.list.push(e)}}));else{let e=[];t.attributes&&(e=t.attributes);let s={key:t.sellerId,sort:t.sellerName,checkedAll:!0,checkedValue:[],moreNum:2,child:[]},i={coverImg:t.goodsIcon,skuId:t.skuId,img:t.imgUrl1||this.$defaultGoodsImage,price:t.discountPrice?t.discountPrice:t.sellingPrice,describe:t.goodsName,count:t.goodsNum,id:t.goodsId,freightAmount:t.freightAmount||0,goodsTax:t.goodsTax||0,selected:!0,isShelf:t.isShelf,attributes:e};s.child.unshift(i),this.list.unshift(s)}}));for(var i=0;i<this.list.length-1;i++)for(var n=i+1;n<this.list.length;n++)this.list[i].sort==this.list[n].sort&&(this.list.splice(n,1),n--)}20==t.length?(this.pageNum++,this.getCartlist()):this.$ls.set("cartList",this.list),setTimeout((()=>{this.handleCheckAll()}),100)},toBuy(){const t=this.list.map((t=>({...t,child:t.child.filter((t=>0!==t.isShelf))}))).filter((t=>t.child.length>0)),e=t.find((t=>t.child.find((t=>t.selected))));if(!e)return(0,o.Z)(this.$t("未选中任何商品"));const s=[];t.forEach((t=>{t.checkedAll&&(t.child=t.child.filter((t=>t.selected)),s.push(t))})),this.$ls.set("cartList",s),this.list=[],this.$router.push("/orderComnfirmation?isCart=1")},handlecheckItemClick(t,e,s){this.list[e].child[s].selected=!this.list[e].child[s].selected;let i=0,n=0,o=this.list[e].child.length;this.list[e].child.forEach((t=>{t.selected?i+=1:n+=1,0!=i&&(this.list[e].checkedAll=!0),n==o&&(this.list[e].checkedAll=!1)}))},handleCheckItemAll(t,e){this.list[e].checkedValue=[],this.$nextTick((()=>{this.list[e].child.forEach(((s,i)=>{s.selected=t,t&&this.list[e].checkedValue.push(s.tempId)}))}))},handleCheckAll(){this.list.forEach((t=>{t.checkedValue=[],t.checkedAll=this.checkedAllTotol,t.child?.forEach((e=>{e.selected=this.checkedAllTotol,this.checkedAllTotol&&t.checkedValue.push(e.tempId)}))}))},onRefresh(){this.finished=!1,this.list=[],this.loading=!0,this.onLoad()},onLoad(){this.refreshing&&(this.list=[],this.refreshing=!1),this.getCartlist()},qiehuan(){this.list=[],this.loading=!1,this.finished=!1,this.refreshing=!1,this.page_no=0},goods_points_action(){this.show=!0,(0,m.cy)({}).then((t=>{this.show=!1,this.goods_points_action_data=t.points}))},touzi(t){this.$router.push("/InvestmentDetails?goodsId="+t)},onClickLeft(){this.$router.push("/me")}},watch:{list:{handler(t){this.checkedAllTotol=t.every((t=>t.child.every((t=>t.selected))))},deep:!0}}},v=p,k=s(80062),C=(0,k.Z)(v,i,n,!1,null,"144cf545",null),y=C.exports},907:function(t,e,s){t.exports=s.p+"img/gouwuche1.19a2de40.png"}}]);