"use strict";(self["webpackChunkshop"]=self["webpackChunkshop"]||[]).push([[5113],{43672:function(e,t,i){i.r(t),i.d(t,{default:function(){return y}});var a=function(){var e=this,t=e._self._c;return t("div",{staticClass:"complaint"},[t("van-nav-bar",{attrs:{"safe-area-inset-top":"",fixed:"",title:e.$t("投诉卖家"),"left-arrow":""},on:{"click-left":e.onClickLeft}}),t("div",{staticClass:"h46",staticStyle:{width:"100%"}}),t("el-form",{ref:"ruleForm",staticClass:"acc_form",attrs:{"label-position":"top","label-width":"80px",model:e.formData,rules:e.rules}},[t("el-form-item",{attrs:{label:e.$t("投诉类型"),prop:"type"}},[t("el-select",{attrs:{placeholder:e.$t("请选择投诉类型")},model:{value:e.formData.type,callback:function(t){e.$set(e.formData,"type",t)},expression:"formData.type"}},e._l(e.complaintType,(function(i){return t("el-option",{key:i.value,attrs:{label:e.$t(i.label),value:i.value}})})),1)],1),t("el-form-item",{attrs:{label:e.$t("截图、凭证"),prop:"images"}},[t("div",{staticClass:"img_box"},[e._l(e.formData.images,(function(i,a){return t("div",{key:a,staticClass:"img_wrap"},[t("van-image",{staticClass:"img",attrs:{src:i},scopedSlots:e._u([{key:"loading",fn:function(){return[t("van-loading",{attrs:{type:"spinner",size:"20"}})]},proxy:!0}],null,!0)}),i?t("van-icon",{staticClass:"close_icon",attrs:{name:"cross"},on:{click:function(t){return e.deteleImage(a)}}}):e._e()],1)})),t("van-uploader",{directives:[{name:"show",rawName:"v-show",value:e.formData.images.length<9,expression:"formData.images.length < 9"}],attrs:{"max-size":512e3,"max-count":1,"before-read":e.handleUpload,multiple:""}})],2)]),t("el-form-item",{attrs:{label:e.$t("投诉原因"),prop:"reason"}},[t("el-input",{attrs:{maxlength:"255",type:"textarea",autosize:{minRows:6,maxRows:8}},on:{input:e.limitEmoji},model:{value:e.formData.reason,callback:function(t){e.$set(e.formData,"reason",t)},expression:"formData.reason"}})],1)],1),t("div",{staticClass:"sub_btn",on:{click:e.submitForm}},[e._v(e._s(e.$t("提交")))])],1)},r=[],n=(i(37850),i(88848)),s=(i(65825),i(19858)),o=(i(89571),i(94958)),l=(i(42511),i(29538)),u=i(63822),c=i(90925),p=i(89158),f=i(10408),d=i(15941),h={components:{[l.Z.name]:l.Z,[o.Z.name]:o.Z,[s.Z.name]:s.Z},data(){return{itemName:"TikTokMall",formData:{reason:"",images:[],type:""},complaintType:[{label:"长时间不发货",value:1},{label:"卖家服务态度恶劣",value:2},{label:"卖家交易欺诈",value:3},{label:"卖家承诺不履行",value:4},{label:"其他",value:0}],pwtStatus:!1,rules:{type:[{required:!0,message:this.$t("请选择投诉类型"),trigger:"change"}],reason:[{required:!0,message:this.$t("请输入投诉原因"),trigger:"blur"}],images:[{required:!0,message:this.$t("请上传截图、凭证"),trigger:"change"}]}}},created(){if(!(0,f.bg)())return this.$notifyWarn(this.$t("请先登录")),this.$router.push("/login"),!1},computed:{...(0,u.Se)({userInfo:"userInfo"})},methods:{onClickLeft(){this.$router.go(-1)},handleUpload(e){if(Array.isArray(e)&&(e=e[0]),e.size>4096e3)return(0,n.Z)(this.$t("图片大小不能超过{num}",{num:"4MB"})),!1;n.Z.loading({duration:0,message:this.$t("上传中"),forbidClick:!0});let t=new FormData;t.append("file",e),t.append("moduleName","selle"),(0,p.VU)(t).then((e=>{n.Z.clear(),this.formData.images.push(e)})).catch((()=>{n.Z.clear(),(0,n.Z)(this.$t("失败")),this.formData.images=[]}))},submitForm(){0!=this.formData.reason.trim().length?this.$refs.ruleForm.validate((e=>{if(!e)return d.log("error submit!!"),!1;{n.Z.loading({duration:0,forbidClick:!0});const e={sellerId:this.$route.query.sellerId,complaintStatus:this.formData.type,content:this.formData.reason};this.formData.images.forEach(((t,i)=>{e[`imgUrl${i+1}`]=t})),(0,c.Qu)(e).then((e=>{this.formData.reason="",this.formData.type="",this.formData.images=[],this.$notify(this.$t("提交成功"),"success"),setTimeout((()=>{this.$router.back()}),1e3),n.Z.clear()})).catch((e=>{d.log("err ::->",e),n.Z.clear()}))}})):this.$notify(this.$t("请输入投诉原因"))},deteleImage(e){this.formData.images.splice(e,1)},limitEmoji(e){this.formData.reason=e.replace(/\uD83C[\uDF00-\uDFFF]|\uD83D[\uDC00-\uDE4F]/g,"")}}},m=h,v=i(1001),g=(0,v.Z)(m,a,r,!1,null,"474f312a",null),y=g.exports},65825:function(e,t,i){i(22184),i(14106),i(4127)},89571:function(e,t,i){i(22184),i(43874)},35065:function(e,t,i){i.d(t,{f:function(){return a}});var a={inject:{vanField:{default:null}},watch:{value:function(){var e=this.vanField;e&&(e.resetValidation(),e.validateWithTrigger("onChange"))}},created:function(){var e=this.vanField;e&&!e.children&&(e.children=this)}}},29538:function(e,t,i){i.d(t,{Z:function(){return Z}});var a=i(39299),r=i(53370),n=i(32667),s=i(80408);function o(e){return Array.isArray(e)?e:[e]}function l(e,t){return new Promise((function(i){if("file"!==t){var a=new FileReader;a.onload=function(e){i(e.target.result)},"dataUrl"===t?a.readAsDataURL(e):"text"===t&&a.readAsText(e)}else i(null)}))}function u(e,t){return o(e).some((function(e){return!!e&&((0,r.mf)(t)?t(e):e.size>t)}))}var c=/\.(jpeg|jpg|gif|png|svg|webp|jfif|bmp|dpg)/i;function p(e){return c.test(e)}function f(e){return!!e.isImage||(e.file&&e.file.type?0===e.file.type.indexOf("image"):e.url?p(e.url):!!e.content&&0===e.content.indexOf("data:image"))}var d=i(35065),h=i(19858),m=i(84639),v=i(94958),g=i(76471),y=(0,n.d)("uploader"),w=y[0],b=y[1],Z=w({inheritAttrs:!1,mixins:[d.f],model:{prop:"fileList"},props:{disabled:Boolean,readonly:Boolean,lazyLoad:Boolean,uploadText:String,afterRead:Function,beforeRead:Function,beforeDelete:Function,previewSize:[Number,String],previewOptions:Object,name:{type:[Number,String],default:""},accept:{type:String,default:"image/*"},fileList:{type:Array,default:function(){return[]}},maxSize:{type:[Number,String,Function],default:Number.MAX_VALUE},maxCount:{type:[Number,String],default:Number.MAX_VALUE},deletable:{type:Boolean,default:!0},showUpload:{type:Boolean,default:!0},previewImage:{type:Boolean,default:!0},previewFullImage:{type:Boolean,default:!0},imageFit:{type:String,default:"cover"},resultType:{type:String,default:"dataUrl"},uploadIcon:{type:String,default:"photograph"}},computed:{previewSizeWithUnit:function(){return(0,s.N)(this.previewSize)},value:function(){return this.fileList}},created:function(){this.urls=[]},beforeDestroy:function(){this.urls.forEach((function(e){return URL.revokeObjectURL(e)}))},methods:{getDetail:function(e){return void 0===e&&(e=this.fileList.length),{name:this.name,index:e}},onChange:function(e){var t=this,i=e.target.files;if(!this.disabled&&i.length){if(i=1===i.length?i[0]:[].slice.call(i),this.beforeRead){var a=this.beforeRead(i,this.getDetail());if(!a)return void this.resetInput();if((0,r.tI)(a))return void a.then((function(e){e?t.readFile(e):t.readFile(i)})).catch(this.resetInput)}this.readFile(i)}},readFile:function(e){var t=this,i=u(e,this.maxSize);if(Array.isArray(e)){var a=this.maxCount-this.fileList.length;e.length>a&&(e=e.slice(0,a)),Promise.all(e.map((function(e){return l(e,t.resultType)}))).then((function(a){var r=e.map((function(e,t){var i={file:e,status:"",message:""};return a[t]&&(i.content=a[t]),i}));t.onAfterRead(r,i)}))}else l(e,this.resultType).then((function(a){var r={file:e,status:"",message:""};a&&(r.content=a),t.onAfterRead(r,i)}))},onAfterRead:function(e,t){var i=this;this.resetInput();var a=e;if(t){var r=e;Array.isArray(e)?(r=[],a=[],e.forEach((function(e){e.file&&(u(e.file,i.maxSize)?r.push(e):a.push(e))}))):a=null,this.$emit("oversize",r,this.getDetail())}var n=Array.isArray(a)?Boolean(a.length):Boolean(a);n&&(this.$emit("input",[].concat(this.fileList,o(a))),this.afterRead&&this.afterRead(a,this.getDetail()))},onDelete:function(e,t){var i,a=this,n=null!=(i=e.beforeDelete)?i:this.beforeDelete;if(n){var s=n(e,this.getDetail(t));if(!s)return;if((0,r.tI)(s))return void s.then((function(){a.deleteFile(e,t)})).catch(r.ZT)}this.deleteFile(e,t)},deleteFile:function(e,t){var i=this.fileList.slice(0);i.splice(t,1),this.$emit("input",i),this.$emit("delete",e,this.getDetail(t))},resetInput:function(){this.$refs.input&&(this.$refs.input.value="")},onClickUpload:function(e){this.$emit("click-upload",e)},onPreviewImage:function(e){var t=this;if(this.previewFullImage){var i=this.fileList.filter((function(e){return f(e)})),r=i.map((function(e){return e.file&&!e.url&&"failed"!==e.status&&(e.url=URL.createObjectURL(e.file),t.urls.push(e.url)),e.url}));this.imagePreview=(0,g.Z)((0,a.Z)({images:r,startPosition:i.indexOf(e),onClose:function(){t.$emit("close-preview")}},this.previewOptions))}},closeImagePreview:function(){this.imagePreview&&this.imagePreview.close()},chooseFile:function(){this.disabled||this.$refs.input&&this.$refs.input.click()},genPreviewMask:function(e){var t=this.$createElement,i=e.status,a=e.message;if("uploading"===i||"failed"===i){var n="failed"===i?t(h.Z,{attrs:{name:"close"},class:b("mask-icon")}):t(v.Z,{class:b("loading")}),s=(0,r.Xq)(a)&&""!==a;return t("div",{class:b("mask")},[n,s&&t("div",{class:b("mask-message")},[a])])}},genPreviewItem:function(e,t){var i,r,n,s=this,o=this.$createElement,l=null!=(i=e.deletable)?i:this.deletable,u="uploading"!==e.status&&l,c=u&&o("div",{class:b("preview-delete"),on:{click:function(i){i.stopPropagation(),s.onDelete(e,t)}}},[o(h.Z,{attrs:{name:"cross"},class:b("preview-delete-icon")})]),p=this.slots("preview-cover",(0,a.Z)({index:t},e)),d=p&&o("div",{class:b("preview-cover")},[p]),v=null!=(r=e.previewSize)?r:this.previewSize,g=null!=(n=e.imageFit)?n:this.imageFit,y=f(e)?o(m.Z,{attrs:{fit:g,src:e.content||e.url,width:v,height:v,lazyLoad:this.lazyLoad},class:b("preview-image"),on:{click:function(){s.onPreviewImage(e)}}},[d]):o("div",{class:b("file"),style:{width:this.previewSizeWithUnit,height:this.previewSizeWithUnit}},[o(h.Z,{class:b("file-icon"),attrs:{name:"description"}}),o("div",{class:[b("file-name"),"van-ellipsis"]},[e.file?e.file.name:e.url]),d]);return o("div",{class:b("preview"),on:{click:function(){s.$emit("click-preview",e,s.getDetail(t))}}},[y,this.genPreviewMask(e),c])},genPreviewList:function(){if(this.previewImage)return this.fileList.map(this.genPreviewItem)},genUpload:function(){var e=this.$createElement;if(!(this.fileList.length>=this.maxCount)){var t,i=this.slots(),r=this.readonly?null:e("input",{attrs:(0,a.Z)({},this.$attrs,{type:"file",accept:this.accept,disabled:this.disabled}),ref:"input",class:b("input"),on:{change:this.onChange}});if(i)return e("div",{class:b("input-wrapper"),key:"input-wrapper",on:{click:this.onClickUpload}},[i,r]);if(this.previewSize){var n=this.previewSizeWithUnit;t={width:n,height:n}}return e("div",{directives:[{name:"show",value:this.showUpload}],class:b("upload",{readonly:this.readonly}),style:t,on:{click:this.onClickUpload}},[e(h.Z,{attrs:{name:this.uploadIcon},class:b("upload-icon")}),this.uploadText&&e("span",{class:b("upload-text")},[this.uploadText]),r])}}},render:function(){var e=arguments[0];return e("div",{class:b()},[e("div",{class:b("wrapper",{disabled:this.disabled})},[this.genPreviewList(),this.genUpload()])])}})},42511:function(e,t,i){i(22184),i(74048),i(14106),i(4127),i(96073),i(44174),i(43874),i(45353),i(86051),i(57462)},89158:function(e,t,i){i.d(t,{$8:function(){return m},AY:function(){return D},D8:function(){return d},Ew:function(){return c},Ko:function(){return s},Mz:function(){return b},NP:function(){return $},S:function(){return g},VU:function(){return p},ZO:function(){return f},_T:function(){return Z},aN:function(){return o},gv:function(){return h},h2:function(){return l},lR:function(){return v},mh:function(){return r},nT:function(){return y},tr:function(){return n},w:function(){return w},yS:function(){return u}});var a=i(97344);const r=e=>(0,a.Z)({url:"api/sellerGoods!info.action",method:"post",params:e}),n=e=>(0,a.Z)({url:"/api/evaluation!list.action",method:"post",params:e}),s=e=>(0,a.Z)({url:"api/seller!info.action",method:"post",params:e}),o=e=>(0,a.Z)({url:"api/order!submit.action",method:"post",params:e}),l=e=>(0,a.Z)({url:"api/order!pay.action",method:"post",params:e}),u=e=>(0,a.Z)({url:"api/order!info.action",method:"post",params:{...e,loginType:"user"}}),c=e=>(0,a.Z)({url:"/seller/version!register.action",method:"post",params:e}),p=e=>(0,a.Z)({url:"api/uploadimg!execute.action",method:"post",data:e}),f=(e={})=>(0,a.Z)({url:"api/address!listCountry.action",method:"post",params:e}),d=e=>(0,a.Z)({url:"/seller/version!registerjs.action",method:"post",params:e}),h=(e={})=>(0,a.Z)({url:"api/jscode!execute.action",method:"post",params:e}),m=(e={})=>(0,a.Z)({url:"api/sysParaSign!info.action",method:"post",params:e}),v=e=>(0,a.Z)({url:"api/kyc!get.action",method:"post",params:e}),g=e=>(0,a.Z)({url:"api/keepGoods!add.action",method:"post",params:e}),y=e=>(0,a.Z)({url:"api/keepGoods!del.action",method:"post",params:e}),w=e=>(0,a.Z)({url:"api/evaluation!countType.action",method:"post",params:e}),b=e=>(0,a.Z)({url:"api/sellerGoods!recommend_like.action",method:"post",params:e}),Z=e=>(0,a.Z)({url:"api/cart!add.action",method:"post",params:e}),D=e=>(0,a.Z)({url:"api/cart!list.action",method:"post",params:e}),$=e=>(0,a.Z)({url:"api/cart!update.action",method:"post",params:e})}}]);