"use strict";(self["webpackChunkshop"]=self["webpackChunkshop"]||[]).push([[2498],{62498:function(t,e,s){s.r(e),s.d(e,{default:function(){return f}});var i=function(){var t=this,e=t._self._c;return e("div",{staticClass:"service-box"},[e("van-nav-bar",{ref:"header",attrs:{"safe-area-inset-top":"",title:t.$t("消息列表"),"left-arrow":"",fixed:""},on:{"click-left":t.onClickLeft}}),e("div",{staticClass:"h46",staticStyle:{width:"100%"}}),"EShop"==t.itemName?e("div",{staticClass:"notify"},[t._m(0),e("div",{staticClass:"content",on:{click:function(e){return t.handleJump2("/message/notify")}}},[e("span",[t._v(t._s(t.$t("系统消息")))]),"Customer complaint success notification"==t.notifyInfo.title?e("span",{staticClass:"nowrap"},[t._v(" "+t._s(t.$t("您的投诉的{storeName}，投诉原因：{complaintReason}，经系统审核，情况属实，并扣除店铺信誉积分{creditScore}，感谢您反馈，给您带来的不便，还请谅解！",{storeName:t.notifyInfo.storeName,complaintReason:t.$t(t.notifyInfo.complaintReason),creditScore:t.notifyInfo.creditScore}))+" ")]):t._e(),"Customer complaint rejection notification"==t.notifyInfo.title?e("span",{staticClass:"nowrap"},[t._v(" "+t._s(t.$t("您的投诉的{storeName}，投诉原因：{complaintReason}，经系统审核被驳回，驳回理由：{rejectionReason}",{storeName:t.notifyInfo.storeName,complaintReason:t.$t(t.notifyInfo.complaintReason),rejectionReason:t.notifyInfo.creditScore}))+" ")]):t._e(),t.notifyInfo?.title?t._e():e("span",[t._v("--")])]),e("div",{staticClass:"time"},[t._v(" "+t._s(t.notifyInfo?.title?t.shourtTimeString(t.notifyInfo.reserveSendTime):"")+" "),0!=t.unreadCount?e("span",{staticClass:"unreadmsg"},[t._v(" "+t._s(t.unreadCount>9?"9+":t.unreadCount)+" ")]):e("span",{staticClass:"unreadmsg",staticStyle:{opacity:"0"}})])]):t._e(),t._l(t.messageList,(function(s){return e("div",{key:s.uid,staticClass:"message",on:{click:function(e){return t.handleJump(s)}}},[e("div",{staticClass:"img"},[e("img",{attrs:{src:s.avatar,alt:""}})]),e("div",{staticClass:"content"},[e("span",{staticStyle:{"font-weight":"400"}},[t._v(t._s(s.username))]),e("span",{staticClass:"nowrap"},[t._v(t._s("{"==s.content.at(0)?t.$t("图片信息"):s.content))])]),e("div",{staticClass:"time"},[t._v(" "+t._s(t.shourtTimeString(s.updatetime))+" "),0!=s.unreadmsg?e("span",{staticClass:"unreadmsg"},[t._v(" "+t._s(s.unreadmsg>9?"9+":s.unreadmsg)+" ")]):e("span",{staticClass:"unreadmsg",staticStyle:{opacity:"0"}})])])}))],2)},n=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"img1"},[e("img",{attrs:{src:s(71317),alt:""}})])}],o=(s(73927),s(81228)),a=s(17223),r=s(14534),l={name:"CustomerService",data(){return{itemName:"SM-wholesaleShop",messageList:[],shourtTimeString:a.Rw,notifyInfo:{},timer:null,unreadCount:0}},mounted(){"EShop"==this.itemName&&(this.requestSystemMessage(),this.requestUnreadSystemMessage()),this.requestMessageList(),this.timer=setInterval((()=>{this.requestMessageList()}),5e3)},methods:{onClickLeft(){this.$router.push("/")},handleJump(t){localStorage.setItem("storeName",t.username),localStorage.setItem("sellerId",t.partyid),sessionStorage.setItem("shopName",t.username),sessionStorage.setItem("sellerId",t.partyid),setTimeout((()=>{this.$router.push("/customerService2")}),200)},handleJump2(t){if(!this.notifyInfo?.title)return this.$toast(this.$t("暂无系统消息"));this.$router.push(t)},requestMessageList(){(0,o.jw)().then((t=>{this.messageList=t}))},requestSystemMessage(){(0,o.nx)({module:0,type:3,status:0,pageSize:1,pageNum:1,totalElements:-1}).then((t=>{0!=t.elements.length?(t.elements.forEach((t=>{if("Customer complaint success notification"==t.title){const e=/The (.*) that you complained, the reason for the complaint: (.*), after review by the system, the situation is true, and the store reputation points (\d+) will be deducted./,s=t.content.match(e),i=s[1];let n=s[2];const o=s[3];"No delivery for a long time"==n?n="长时间不发货":"seller’s poor service attitude"==n?n="卖家服务态度恶劣":"seller’s transaction fraud"==n?n="卖家交易欺诈":"seller’s failure to fulfill promises"==n?n="卖家承诺不履行":"other"==n&&(n="其他"),t.complaintReason=n,t.creditScore=o,t.storeName=i}else if("Customer complaint rejection notification"==t.title){const e=/The (.*) that you complained, the reason for the complaint: (.*), was rejected after review by the system, the reason for rejection: (.*)/,s=t.content.match(e),i=s[1];let n=s[2];const o=s[3];"No delivery for a long time"==n?n="长时间不发货":"seller’s poor service attitude"==n?n="卖家服务态度恶劣":"seller’s transaction fraud"==n?n="卖家交易欺诈":"seller’s failure to fulfill promises"==n?n="卖家承诺不履行":"other"==n&&(n="其他"),t.complaintReason=n,t.creditScore=o,t.storeName=i}})),this.notifyInfo=t.elements[0],r.log("this.notifyInfo ::->",this.notifyInfo)):this.notifyInfo={}}))},requestUnreadSystemMessage(){(0,o.OC)({type:3,module:"0"}).then((t=>{this.unreadCount=t.count}))}},unMounted(){clearInterval(this.timer)}},c=l,m=s(80062),u=(0,m.Z)(c,i,n,!1,null,"0750e0fa",null),f=u.exports},71317:function(t){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAAAXNSR0IArs4c6QAAAfpJREFUeF7tm0FywyAMRcXJ2pyszcmam6mjDs64mWCBJAQ28iYLB8d6+vpyACdY/EiLxw8BIBQwgAAifgLAFwDQJx13AHiklB7etzOkBBARC4HevCG4A0DE75z9dwxIBTdPFYwA8LOT/musSwAoyf8PRkrJNSmuP0YBHtT/tQG8cf5SqVNHICWQV3Q/uiqgIegijN4gugFg3L41s/deIMwBGGS9BKdLhzAFkIOnNtfzMH1YMgPgFPwG1gyCJYDD/t5BEiYQTAAYG14tKxNPUAMYFPwGSd0dLAB4S/+fQrSPzioAg7NvYohaAEOznwmovEAMwLntccYo7ggaAEcTG9wNW58fAuBoYsM6QO564jLQKGB5ADMY4FMZ0naoUUAA4ArT83woQDiZGiUglSk3uyu9rnRclECUgGxBJTxAWnPhAeUlbilT1bgwwTDBMEGRoYsGUbGGCa5sgpPMBr92DdEaQXMJTBq8eKGkCcDkwYsgVAM4SfDNEKoAnCz4JggsgJMGX71sdnUAbGcIANxfsLwGuO3q5r4+23l2BzqrgNkisr6fAGBN9GzXc1NAo5ewtWsF2htA7SZKtn1dGoB0fk8CxU0BeRKlZleJW/bpnlwBVEAQ7/SQZH8IgB2Ej927Q/S6HGV+jdfmpNnqMc69BHoEoblmANDQu8LYXwBq90FxjGB0AAAAAElFTkSuQmCC"}}]);