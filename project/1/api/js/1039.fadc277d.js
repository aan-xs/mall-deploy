"use strict";(self["webpackChunkshop"]=self["webpackChunkshop"]||[]).push([[1039],{16948:function(t,i,e){e.r(i),e.d(i,{default:function(){return b}});var a=function(){var t=this,i=t._self._c;return i("div",{staticClass:"AddressDetails",staticStyle:{"min-height":"100vh"}},[i("nationality-list",{ref:"controlChild",attrs:{title:t.$t("选择区域码")},on:{getName:function(i){return t.getName(arguments)}}}),i("van-nav-bar",{attrs:{"safe-area-inset-top":"",fixed:"",title:t.$t("新增地址/修改地址"),"right-text":t.$t("保存"),"left-arrow":""},on:{"click-left":t.onClickLeft,"click-right":t.submitHandle}}),i("div",{staticStyle:{width:"100%",height:"46px"}}),i("div",{staticClass:"form-content"},[i("div",{staticClass:"item"},[i("el-input",{attrs:{placeholder:t.$t("收货人姓名"),clearable:"",maxlength:"64","show-word-limit":""},on:{input:function(i){return t.inputVal("contacts",i)}},model:{value:t.formData.contacts,callback:function(i){t.$set(t.formData,"contacts",i)},expression:"formData.contacts"}})],1),i("div",{staticClass:"item"},[i("el-input",{attrs:{placeholder:t.$t("邮箱"),clearable:"",maxlength:"64","show-word-limit":""},model:{value:t.formData.email,callback:function(i){t.$set(t.formData,"email","string"===typeof i?i.trim():i)},expression:"formData.email"}})],1),i("div",{staticClass:"item"},[i("el-input",{attrs:{placeholder:t.$t("手机号"),maxlength:"20",value:t.formData.phone},on:{input:t.handleInputChange}},[i("div",{attrs:{slot:"prepend"},on:{click:t.openNational},slot:"prepend"},[i("p",[t._v(" +"),i("span",[t._v(t._s(t.dialCode))]),i("img",{staticClass:"icon",attrs:{src:t.triangleDown,alt:""}})])])])],1),i("div",{staticClass:"address_item"},[i("el-select",{attrs:{filterable:"",placeholder:t.$t("请选择"),"no-data-text":t.$t("暂无数据"),"no-match-text":t.$t("暂无数据"),"loading-text":t.$t("加载中")},on:{change:t.onCountryChange},model:{value:t.formData.country,callback:function(i){t.$set(t.formData,"country",i)},expression:"formData.country"}},t._l(t.countryList,(function(t){return i("el-option",{key:t.id,attrs:{"value-key":"countryName",label:t.label,value:t.countryName}})})),1),t.isProvince?i("el-select",{attrs:{filterable:"",placeholder:t.$t("请选择"),"no-data-text":t.$t("暂无数据"),"no-match-text":t.$t("暂无数据"),"loading-text":t.$t("加载中")},on:{change:t.onProvinceChange},model:{value:t.formData.province,callback:function(i){t.$set(t.formData,"province",i)},expression:"formData.province"}},t._l(t.provinceList,(function(t){return i("el-option",{key:t.id,attrs:{"value-key":"stateName",label:t.label,value:t.stateName}})})),1):t._e(),t.isProvince&&t.isCity?i("el-select",{attrs:{filterable:"","no-data-text":t.$t("暂无数据"),"no-match-text":t.$t("暂无数据"),"loading-text":t.$t("加载中"),placeholder:t.$t("请选择")},on:{change:t.onCityChange},model:{value:t.formData.city,callback:function(i){t.$set(t.formData,"city",i)},expression:"formData.city"}},t._l(t.cityList,(function(t){return i("el-option",{key:t.id,attrs:{"value-key":"cityName",label:t.label,value:t.cityName}})})),1):t._e()],1),i("div",{staticClass:"item"},[i("el-input",{attrs:{placeholder:t.$t("邮编"),maxlength:"32","show-word-limit":"",clearable:""},model:{value:t.formData.postcode,callback:function(i){t.$set(t.formData,"postcode",i)},expression:"formData.postcode"}})],1),i("div",{staticClass:"item"},[i("el-input",{attrs:{type:"textarea",placeholder:t.$t("收件地址"),resize:"none",maxlength:"255","show-word-limit":"",autosize:{minRows:3,maxRows:4},clearable:""},model:{value:t.formData.address,callback:function(i){t.$set(t.formData,"address",i)},expression:"formData.address"}})],1),i("div",{staticClass:"item check"},[i("div",{staticStyle:{flex:"1"}},[t._v(t._s(t.$t("设为默认地址")))]),i("van-switch",{attrs:{size:"20px"},model:{value:t.checked,callback:function(i){t.checked=i},expression:"checked"}})],1)])],1)},s=[],o=(e(37850),e(88848)),n=(e(60836),e(46811)),r=(e(4075),e(24588)),c=(e(22184),e(43874),e(32667)),l=e(80408),h={size:[Number,String],value:null,loading:Boolean,disabled:Boolean,activeColor:String,inactiveColor:String,activeValue:{type:null,default:!0},inactiveValue:{type:null,default:!1}},d=e(35065),u=e(94958),m=(0,c.d)("switch"),f=m[0],v=m[1],y=f({mixins:[d.f],props:h,computed:{checked:function(){return this.value===this.activeValue},style:function(){return{fontSize:(0,l.N)(this.size),backgroundColor:this.checked?this.activeColor:this.inactiveColor}}},methods:{onClick:function(t){if(this.$emit("click",t),!this.disabled&&!this.loading){var i=this.checked?this.inactiveValue:this.activeValue;this.$emit("input",i),this.$emit("change",i)}},genLoading:function(){var t=this.$createElement;if(this.loading){var i=this.checked?this.activeColor:this.inactiveColor;return t(u.Z,{class:v("loading"),attrs:{color:i}})}}},render:function(){var t=arguments[0],i=this.checked,e=this.loading,a=this.disabled;return t("div",{class:v({on:i,loading:e,disabled:a}),attrs:{role:"switch","aria-checked":String(i)},style:this.style,on:{click:this.onClick}},[t("div",{class:v("node")},[this.genLoading()])])}}),p=(e(83627),e(90797)),C=e(14970),g=e(38211),D=e(90925),$=(e(55243),e(15941)),A={data(){return{triangleDown:e(44499),pageDiaCode:!1,dialCode:localStorage.getItem("dialCode")||1,checked:!0,showCountryPicker:!1,showCityPicker:!1,showProvincePicker:!1,formData:{contacts:"",email:"",phone:"",country:"",province:"",city:"",postcode:"",address:"",countryId:0,provinceId:0,cityId:0},currentId:null,cityList:[],provinceList:[],countryList:[],countryId:0,provinceId:0,isProvince:!0,isCity:!0,currentCountryId:null}},components:{[p.Z.name]:p.Z,[y.name]:y,NationalityList:g.Z,[r.Z.name]:r.Z,[n.Z.name]:n.Z},created(){const{id:t}=this.$route.query;t&&(this.currentId=t,this.getAddressInfo()),this.getCountry()},methods:{async getCountry(){const t=await(0,D.ZO)();this.countryList=t.data},async getStateList(t){const i=await(0,D.jv)({countryId:+t});this.provinceList=i.data,0==this.provinceList.length&&(this.isProvince=!1,this.provinceList=[{stateName:this.$t("暂无数据"),id:""}])},async getListCity(t){const i=await(0,D.Bi)({stateId:t});this.cityList=i.data,0==this.cityList.length?(this.isCity=!1,this.cityList=[{cityName:this.$t("暂无数据"),id:""}]):this.isCity=!0},onCityChange(t){this.cityList.find((i=>{i.cityName==t&&(this.formData.cityId=i.id)})),this.formData.city=t},onCityCancel(){this.showCityPicker=!1},onCountryChange(t){this.countryList.find((i=>{i.countryName==t&&(this.formData.country=t,this.formData.countryId=i.id,this.currentCountryId=this.countryId=i.id,this.isProvince=!0,this.showCountryPicker=!1,this.getStateList(i.id))})),this.formData.city=this.formData.province="",this.formData.cityId=this.formData.provinceId=0},onCountryCancel(){this.showCountryPicker=!1},onProvinceChange(t){this.provinceList.find((i=>{i.stateName==t&&(this.formData.province=t,this.formData.provinceId=i.id,this.provinceId=i.id,this.showProvincePicker=!1,this.getListCity(i.id))})),this.formData.city=""},onProvinceCancel(){this.showProvincePicker=!1},clickCountry(){document.activeElement.blur(),this.showCountryPicker=!0,this.formData.province="",this.formData.city=""},ProvincePicker(){document.activeElement.blur(),this.formData.city="",""==this.formData.country?(0,o.Z)(this.$t("请输入")+this.$t("国家")):(this.getStateList(this.countryId),this.showProvincePicker=!0)},CityPicker(){document.activeElement.blur(),this.formData.province==this.$t("暂无数据")?this.formData.city=this.$t("暂无数据"):this.formData.country&&this.formData.province?(this.getListCity(this.provinceId),this.showCityPicker=!0):(0,o.Z)(this.$t("请输入")+this.$t("省区"))},getAddressInfo(){o.Z.loading({duration:0,forbidClick:!0}),(0,C.Sd)({}).then((t=>{o.Z.clear();const{pageList:i}=t,e=i.find((t=>String(t.id)===String(this.currentId)));if(e){if(this.checked=Boolean(e.use),this.currentCountryId=e?.countryId,e.phone.indexOf("|")>-1){const t=e.phone.split("|");this.dialCode=t[0],e.phone=t[1]}delete e.use,e?.countryId&&this.getStateList(e.countryId),e?.provinceId&&this.getListCity(e.provinceId),this.formData={...e}}})).catch((t=>{}))},onClickLeft(){this.$router.go(-1)},inputVal(t,i){let e=/([0-9|*|#]\uFE0F\u20E3)|([0-9|#]\u20E3)|([\u203C-\u3299]\uFE0F\u200D)|([\u203C-\u3299]\uFE0F)|([\u2122-\u2B55])|(\u303D)|([(\A9)|(\AE)]\u3030)|(\uA9)|(\uAE)|(\u3030)|([\uD83C|\uD83D|\uD83E][\uDC00-\uDFFF])|([\uD83C|\uD83D|\uD83E][\uDC00-\uDFFF][\u200D|\uFE0F])/g;setTimeout((()=>{this.formData[t]=i.replace(e,"")}),0)},getName(t){this.pageDiaCode?(this.dialCode=t[2],localStorage.setItem("dialCode",this.dialCode)):this.pageDiaCode=!0},openNational(){this.$refs.controlChild.open()},handleInputChange(t){/^[1-9]\d*$|^$/.test(t)&&(this.formData.phone=t)},submitHandle(){if(""===this.formData.contacts)return void(0,o.Z)(this.$t("请输入")+this.$t("名称"));if(""===this.formData.email)return void(0,o.Z)(this.$t("请输入")+this.$t("邮箱"));{const t=/^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}$/;if(!t.test(this.formData.email))return $.log("this.formData.email ::->",this.formData.email),void(0,o.Z)(this.$t("邮箱格式有误"))}if(""===this.formData.phone)return void(0,o.Z)(this.$t("请输入")+this.$t("手机号"));{const t=/^[0-9]+[0-9]*$/;if(!t.test(this.formData.phone))return void(0,o.Z)(this.$t("手机号格式有误"))}if(""===this.formData.country)return void(0,o.Z)(this.$t("请输入")+this.$t("国家"));if(""===this.formData.postcode)return void this.$notifyWarn(this.$t("请输入")+this.$t("邮编"));if(""===this.formData.address)return void this.$notifyWarn(this.$t("请输入")+this.$t("收件地址"));if(this.isProvince&&""==this.formData.province)return void this.$notifyWarn(this.$t("请选择")+this.$t("省区"));if(this.isProvince&&this.isCity&&""==this.formData.city)return void this.$notifyWarn(this.$t("请选择")+this.$t("市"));const t={...this.formData,countryId:this.currentCountryId,phone:`${this.dialCode}|${this.formData.phone}`,use:this.checked?1:0};""==t.province&&delete t.province,""==t.city&&delete t.city;let i=C.O3;this.currentId&&(t.id=this.currentId,i=C.sA),o.Z.loading({duration:0,message:this.$t("提交中"),forbidClick:!0}),i(t).then((()=>{o.Z.success(this.$t("保存成功")),setTimeout((()=>{this.$router.go(-1)}),500)})).catch((t=>{o.Z.clear()}))}}},k=A,I=e(1001),w=(0,I.Z)(k,a,s,!1,null,"50d6fedb",null),b=w.exports},35065:function(t,i,e){e.d(i,{f:function(){return a}});var a={inject:{vanField:{default:null}},watch:{value:function(){var t=this.vanField;t&&(t.resetValidation(),t.validateWithTrigger("onChange"))}},created:function(){var t=this.vanField;t&&!t.children&&(t.children=this)}}},44499:function(t){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAATCAYAAACDW21BAAAACXBIWXMAACE4AAAhOAFFljFgAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAD3SURBVHgB3ZI9DoJAEEZn4QJaQucNNITE0tLWI3gC4xHsLD2Ona0F4B6BCryCBeBMgdkM2WWRxcKXwA6zP182PIB/R9AriqILDgf4AaItMPSGwwamRXptVVXVvmmaHCaCzsaMnVCbcRwv67qmm87AMRi2kFLmvtosiuIZBMFLCLEFh+B5xyzLrlT7fLIsy3sYhnMs1+AADDslSXL+fOsWOpJIpmm6UhuebuVYiVpJeF+YNo2RqJWE933Tpm8lUiUZFEgMlYhL0pkHSywl6kjC8cCSPol0knCsb0iYJNJJwun9hyo6iUySjAokuER9kjiDJMLnAQN5AwgPjbeTqmD3AAAAAElFTkSuQmCC"}}]);