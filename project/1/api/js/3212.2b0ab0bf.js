"use strict";(self["webpackChunkshop"]=self["webpackChunkshop"]||[]).push([[3212],{3212:function(e,t,i){i.r(t),i.d(t,{default:function(){return P}});var a=function(){var e=this,t=e._self._c;return t("div",{staticClass:"merchantSettled"},[t("van-nav-bar",{ref:"header",attrs:{"safe-area-inset-top":"",title:e.$t("贷款申请"),"left-arrow":"",fixed:""},on:{"click-left":function(t){return e.$router.go(-1)}}}),t("div",{staticClass:"merchantSettled-wap"},[t("div",{staticClass:"step-div"},[t("div",[t("div",{staticClass:"content content2"},[t("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-position":"top","label-width":"200px"}},[t("el-form-item",{attrs:{label:e.$t("申请人"),prop:"realName"}},[t("el-input",{attrs:{placeholder:e.$t("真实姓名"),clearable:"",maxlength:100},model:{value:e.ruleForm.realName,callback:function(t){e.$set(e.ruleForm,"realName",t)},expression:"ruleForm.realName"}})],1),t("el-form-item",{attrs:{label:e.$t("贷款期限"),prop:"creditPeriod"}},[t("el-select",{attrs:{placeholder:e.$t("请选择贷款期限")},on:{change:e.handleSelectChange},model:{value:e.ruleForm.creditPeriod,callback:function(t){e.$set(e.ruleForm,"creditPeriod",t)},expression:"ruleForm.creditPeriod"}},e._l(e.creditPeriodList,(function(e){return t("el-option",{key:e.value,style:e.dis&&{color:"#999"},attrs:{label:e.label,value:e.value}})})),1)],1),t("el-form-item",{attrs:{label:e.$t("申请金额"),prop:"applyAmount"}},[t("el-input",{attrs:{placeholder:e.amountMin+"-"+e.amountMax,type:"number",clearable:""},on:{input:e.handleInput,change:e.handleChange},model:{value:e.ruleForm.applyAmount,callback:function(t){e.$set(e.ruleForm,"applyAmount",t)},expression:"ruleForm.applyAmount"}})],1),t("el-form-item",{attrs:{label:e.$t("贷款利率"),prop:"interestRate"}},[t("el-input",{attrs:{placeholder:100*e.rate+"%",disabled:""}})],1),t("el-form-item",{attrs:{label:e.$t("放款方式"),prop:"loanMethod"}},[t("el-input",{attrs:{placeholder:e.$t("账户余额"),disabled:""}})],1),t("el-form-item",{attrs:{label:e.$t("国籍"),prop:"countryId"}},[t("el-select",{attrs:{filterable:"",placeholder:e.$t("请选择"),"no-data-text":e.$t("暂无数据"),"no-match-text":e.$t("暂无数据"),"loading-text":e.$t("加载中")},on:{change:e.onCountryChange},model:{value:e.countryName,callback:function(t){e.countryName=t},expression:"countryName"}},e._l(e.countryList,(function(e){return t("el-option",{key:e.id,attrs:{"value-key":"countryName",label:e.countryName,value:e.id}})})),1)],1),t("el-form-item",{attrs:{label:e.$t("证件号码/护照号码"),prop:"identification"}},[t("el-input",{attrs:{placeholder:e.$t("请输入证件号码或者护照号"),clearable:"",maxlength:50},on:{change:e.idCartChange},model:{value:e.ruleForm.identification,callback:function(t){e.$set(e.ruleForm,"identification",t)},expression:"ruleForm.identification"}})],1),t("el-form-item",{staticClass:"el-form-required-box",attrs:{label:e.$t("证件照/上传护照")}},[t("span",{staticClass:"required"},[e._v("*")]),t("div",{staticClass:"uploder-center"},[t("div",{staticClass:"uploder-two-wrap"},[t("van-uploader",{attrs:{"after-read":e.afterRead2,"max-count":1,accept:".png,.jpg,.jpeg"},on:{delete:function(t){return e.handleDelete(2)}},model:{value:e.fileList2,callback:function(t){e.fileList2=t},expression:"fileList2"}},[e.creditId?t("img",{staticClass:"card_img",attrs:{src:e.ruleForm.imgCertificateFace,alt:""}}):e._e()]),t("div",{staticClass:"tips"},[e._v(e._s(e.$t("证件正面")))])],1),t("div",{staticClass:"uploder-two-wrap"},[t("van-uploader",{attrs:{"after-read":e.afterRead3,"max-count":1,accept:".png,.jpg,.jpeg"},on:{delete:function(t){return e.handleDelete(3)}},model:{value:e.fileList3,callback:function(t){e.fileList3=t},expression:"fileList3"}},[e.creditId?t("img",{staticClass:"card_img",attrs:{src:e.ruleForm.imgCertificateBack,alt:""}}):e._e()]),t("div",{staticClass:"tips"},[e._v(e._s(e.$t("证件反面")))])],1),t("div",{staticClass:"uploder-two-wrap"},[t("van-uploader",{attrs:{"after-read":e.afterRead4,"max-count":1,accept:".png,.jpg,.jpeg"},on:{delete:function(t){return e.handleDelete(4)}},model:{value:e.fileList4,callback:function(t){e.fileList4=t},expression:"fileList4"}},[e.creditId?t("img",{staticClass:"card_img",attrs:{src:e.ruleForm.imgCertificateHand,alt:""}}):e._e()]),t("div",{staticClass:"tips"},[e._v(e._s(e.$t("手持证件照")))])],1)]),t("div",{staticStyle:{display:"flex","flex-direction":"column"}},[t("div",{staticClass:"el-form-item__label",staticStyle:{"margin-bottom":"-26px"}},[e._v(e._s(e.$t("拍摄示例")))]),t("div",{staticClass:"correct-warp"},[t("img",{attrs:{src:i(73700)}}),t("img",{attrs:{src:i(31518)}}),t("img",{attrs:{src:i(84131)}})])])])],1)],1),t("div",{staticClass:"checkout_box"},[t("van-checkbox",{attrs:{shape:"square"},model:{value:e.isAgree,callback:function(t){e.isAgree=t},expression:"isAgree"}},[e._v(e._s(e.$t("我已阅读并同意")))]),t("span",{on:{click:e.handleJump}},[e._v("《"+e._s(e.$t("借款协议"))+"》")])],1),t("div",{staticClass:"bottom"},[t("van-button",{staticClass:"button",attrs:{type:"primary",color:e.mainColor},on:{click:e.requireSellerRegister}},[e._v(e._s(e.$t("提交申请"))+" ")])],1)])])])],1)},r=[],l=(i(43635),i(93407)),s=i(68747),n=i.n(s),o=i(86545),c=i.n(o),d=(i(59701),i(20953)),u=i(4137),m=i.n(u),h=i(87133),p=i.n(h),f=i(16853),g=i.n(f),y=(i(24657),i(42310)),C=(i(2710),i(42418)),$=i(17689),b=i.n($),F=i(91500),v=i.n(F),k=i(51046),x=i.n(k),L=(i(73927),i(22745)),w=i(35075),_=i(17223),A=i(14534),I={data(){return{mainColor:"#f89900",isAlphanumeric:_.JG,creditPeriodList:[],lendableDays:[],defaultRate:[],amountMax:"",amountMin:"",rate:"",priceFormat:_.XY,getStorage:_.cF,isCutting:!1,imgFile:"",ratioWidth:1,ratioHeight:1,step:1,checked:!1,screenWidth:document.body.clientWidth,type:"Email",uploadCheckIndex:1,areaCode:1,isAgree:!1,countryName:"",ruleForm:{creditPeriod:"",realName:"",imgCertificateFace:"",imgCertificateBack:"",imgCertificateHand:"",countryId:"",applyAmount:"",identification:""},labelPosition:"top",isCode:!0,rules:{identification:[{required:!0,message:this.$t("请输入证件号码或者护照号"),trigger:"blur"}],imgCertificateFace:[{required:!0,message:this.$t("请上传身份证正面"),trigger:"blur"}],imgCertificateBack:[{required:!0,message:this.$t("请上传身份证反面"),trigger:"blur"}],imgCertificateHand:[{required:!0,message:this.$t("请上传手持身份证"),trigger:"blur"}],realName:[{required:!0,message:this.$t("请输入真实姓名"),trigger:"blur"},{pattern:/^\S.*\S$|(^\S{0,1}\S$)/,message:this.$t("首尾不能为空格"),trigger:"blur"}],applyAmount:[{required:!0,message:this.$t("请输入金额"),trigger:"blur"}],creditPeriod:[{required:!0,message:this.$t("请选择贷款期限"),trigger:"change"}],countryId:[{required:!0,message:this.$t("请选择国家"),trigger:"change"}]},options:[{label:this.$t("身份证"),value:"身份证"},{label:this.$t("护照"),value:"护照"}],fileList1:[],fileList2:[],fileList3:[],fileList4:[],tabList:[this.$t("电子邮箱"),this.$t("手机号")],tabIndex:0,lang:[{title:"简体中文",key:"cn",icon:i(90876)},{title:"English",key:"en",icon:i(75740)},{title:"繁体中文",key:"tw",icon:i(44012)}],countryList:[],pageDiaCode:!0,creditId:this.$route.query?.creditId||null}},components:{[x().name]:x(),[v().name]:v(),[b().name]:b(),[C.Z.name]:C.Z,[y.Z.name]:y.Z,[g().name]:g(),[p().name]:p(),[m().name]:m(),[d.Z.name]:d.Z,[c().name]:c(),[n().name]:n(),[l.Z.name]:l.Z},created(){this.requireApplyLoanConfig(),this?.creditId&&this.requireBeforereApply(this.creditId),this.requestGetCountryList()},methods:{async requestGetCountryList(){const{data:e}=await(0,w.ZO)();this.countryList=e},onCountryChange(e){this.ruleForm.countryId=e},async requireApplyLoanConfig(){const e=await(0,w.cU)();e.allLendableDays.forEach((t=>{e.lendableDays.forEach((e=>{this.creditPeriodList.push({label:t+this.$t("天"),value:t,dis:t!==e})}))})),this.creditPeriodList=this.deduplication(this.creditPeriodList,"value"),this.creditPeriodList.forEach((t=>{e.lendableDays.forEach((e=>{t.value==e&&(t.dis=!1)}))})),this.lendableDays=e.lendableDays,this.amountMax=e.amountMax,this.amountMin=e.amountMin,this.rate=e.rate},async requireBeforereApply(e){const t=await(0,w.Ts)({creditId:e});this.ruleForm.realName=t.realName,this.ruleForm.applyAmount=t.applyAmount,this.ruleForm.creditPeriod=t.creditPeriod+"",this.handleSelectChange(t.creditPeriod+""),this.rate=t.creditRate,this.ruleForm.countryId=t.countryId,this.ruleForm.identification=t.identification,this.ruleForm.imgCertificateFace=t.imgCertificateFace,this.ruleForm.imgCertificateBack=t.imgCertificateBack,this.ruleForm.imgCertificateHand=t.imgCertificateHand},deduplication(e,t){const i={};return e.reduce(((e,a)=>(!i[a[t]]&&(i[a[t]]=e.push(a)),e)),[])},handleJump(){window.plus?window.plus.runtime.openURL(encodeURI(`${window.origin}/promote/#/contract?lang=${(0,_.cF)("lang")}&wt=app`)):window.open(`${window.origin}/promote/#/contract?lang=${(0,_.cF)("lang")}`)},idCartChange(){this.isAlphanumeric(this.ruleForm.identification)||(this.$notify(this.$t("证件号码/护照号码验证未通过")),this.ruleForm.identification="")},handleDelete(e){this[`fileList${e}`]=[]},requireSellerRegister(){this.$refs["ruleForm"].validate((e=>{if(!e)return!1;if(this.ruleForm.imgCertificateFace&&this.ruleForm.imgCertificateBack&&this.ruleForm.imgCertificateHand){if(!this.isAgree)return this.$notify(this.$t("请阅读并同意借款协议"));this.creditId&&(this.ruleForm.creditId=this.creditId),(0,w.Ye)(this.ruleForm).then((e=>{this.$notify(this.$t("申请成功"),"success"),this.$router.replace("/loan/my")})).catch((e=>{A.log("err ::->",e)}))}else this.$notify(this.$t("请上传证件照片"))}))},handleSelectChange(e){let t=this.lendableDays.find((t=>t==e));!t&&this.$notify(this.$t("未满足资质条件")),!t&&(this.ruleForm.creditPeriod="")},handleInput(){this.ruleForm.applyAmount>this.amountMax?this.ruleForm.applyAmount=this.amountMax:this.ruleForm.applyAmount<1&&(this.ruleForm.applyAmount="")},handleChange(){this.ruleForm.applyAmount<this.amountMin&&(this.ruleForm.applyAmount="",this.$notify(`${this.$t("申请金额不能小于")}${this.amountMin}`))},openNationality(e){this.isCode=1===e,this.$refs.controlChild.open()},afterRead2(e){l.Z.loading({duration:0,message:this.$t("上传中"),forbidClick:!0});let t=new FormData;t.append("file",e.file),t.append("moduleName","selle"),(0,L.VU)(t).then((e=>{this.ruleForm.imgCertificateFace=e})).catch((e=>{this.fileList2=[],l.Z.fail(this.$t("上传失败"))})).finally((()=>{l.Z.clear()}))},afterRead3(e){l.Z.loading({duration:0,message:this.$t("上传中"),forbidClick:!0});let t=new FormData;t.append("file",e.file),t.append("moduleName","selle"),(0,L.VU)(t).then((e=>{this.ruleForm.imgCertificateBack=e})).catch((e=>{this.fileList3=[],l.Z.fail(this.$t("上传失败"))})).finally((()=>{l.Z.clear()}))},afterRead4(e){l.Z.loading({duration:0,message:this.$t("上传中"),forbidClick:!0});let t=new FormData;t.append("file",e.file),t.append("moduleName","selle"),(0,L.VU)(t).then((e=>{this.ruleForm.imgCertificateHand=e})).catch((e=>{this.fileList4=[],l.Z.fail(this.$t("上传失败"))})).finally((()=>{l.Z.clear()}))}}},q=I,Z=i(80062),N=(0,Z.Z)(q,a,r,!1,null,"3011b52a",null),P=N.exports}}]);