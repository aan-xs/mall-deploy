import{_ as A,j as D,i as $,u as j,ai as z,l as E,r as c,q as H,m as M,I as P,c as b,e as f,w as x,a,t as l,b as t,y as q,f as m,n as N,T as p,cl as G,b1 as J,o as C,cm as K,F as O,R as Q,S as W}from"./index-d71e1836.js";import{B as X}from"./index-2b37af5f.js";import"./index-27d29771.js";import{F as Y}from"./index-ac66dd73.js";import{a as Z}from"./login.api-d786b76a.js";import"./use-id-7082c426.js";const ee=h=>(Q("data-v-815bbfd7"),h=h(),W(),h),te={class:"verify-content"},se=ee(()=>a("div",{style:{height:"46px"}},null,-1)),ae={class:"info-content"},oe={class:"info-item"},ne={class:"gap"},le={class:"info-item"},re={class:"gap"},ue={key:0},ie={class:"change-ver-type"},ce={class:"submit-content"},de={__name:"index",setup(h){const v=D(),I=$(),{t:e}=j(),d=z(),V=E(),n=c(1),k=c(1),S=c("44"),y=c(""),u=c(0),_=c(null),g=c(!1);n.value=d.query&&d.query.type?Number(d.query.type):1,k.value=d.query&&d.query.verType?Number(d.query.verType):1,H(()=>{clearInterval(_.value),_.value=null});const w=M(()=>{if(!v.userInfo.token)V.push("/login");else{const{email:r,phone:o}=v.userInfo;let s="";if(n.value===1){if(o){const i=o.split(" ");i.length===2?(S.value=i[0],s=i[1]):s=i[0]}}else s=r||"";return s}}),B=()=>{if(u.value>0)return!1;const{email:r,phone:o}=v.userInfo;p.loading({duration:0,forbidClick:!0}),Z({target:n.value===1?o:r}).then(()=>{p(e("sendSuccess")),u.value=60,_.value=setInterval(()=>{u.value>0?u.value=u.value-1:(u.value=0,clearInterval(_.value),_.value=null)},1e3)}).catch(()=>{p.clear()})},F=()=>{const{email:r,phone:o}=v.userInfo,s=n.value===1?2:1;if(s===2&&!r)return p(e("\u6682\u672A\u7ED1\u5B9A\u90AE\u7BB1\uFF0C\u65E0\u6CD5\u8FDB\u884C\u90AE\u7BB1\u9A8C\u8BC1")),!1;if(s===1&&!o)return p(e("\u6682\u672A\u7ED1\u5B9A\u624B\u673A\u53F7\uFF0C\u65E0\u6CD5\u8FDB\u884C\u624B\u673A\u9A8C\u8BC1")),!1;n.value=s},L=()=>{if(y.value===""){p(e("entryVerifyCode"));return}g.value=!0;const{email:r,phone:o}=v.userInfo,s={target:n.value===1?o:r,verifcode:y.value};n.value===1?s.phone=o:s.email=r,G(s).then(i=>{g.value=!1,V.push(`/bindVerify?type=${k.value}&reset=1&verifyCode=${i.verifyCode}`)}).catch(()=>{g.value=!1})};return(r,o)=>{const s=J,i=Y,T=X,R=P;return C(),b("div",te,[f(s,{fixed:!0},{title:x(()=>[m(l(t(e)("\u8EAB\u4EFD\u9A8C\u8BC1")),1)]),_:1}),se,a("div",ae,[a("div",oe,[a("h2",ne,l(n.value===1?t(e)("\u624B\u673A\u9A8C\u8BC1"):t(e)("\u90AE\u7BB1\u9A8C\u8BC1")),1),a("p",null,l(t(e)("\u4E3A\u4E86\u4FDD\u969C\u60A8\u7684\u8D26\u53F7\u5B89\u5168\uFF0C\u8BF7\u9A8C\u8BC1\u540E\u8FDB\u884C\u4E0B\u4E00\u6B65\u64CD\u4F5C")),1)]),a("div",le,[a("p",re,l(n.value===1?t(e)("\u5F53\u524D\u7ED1\u5B9A\u624B\u673A\u53F7"):t(e)("\u5F53\u524D\u7ED1\u5B9A\u90AE\u7BB1")),1),a("h2",null,[n.value===1?(C(),b("span",ue,"(+"+l(S.value)+")",1)):q("v-if",!0),m(l(t(K)(t(w),!1)),1)])]),a("div",{class:N(["code-content",{"is-ar":t(I)}])},[f(i,{modelValue:y.value,"onUpdate:modelValue":o[0]||(o[0]=U=>y.value=U),type:"tel",label:"",placeholder:t(e)("entryVerifyCode")},null,8,["modelValue","placeholder"]),a("div",{class:N(["btn",{"is-ar":t(I)}])},[f(T,{type:"primary",onClick:B},{default:x(()=>[m(l(t(e)("sendVerifyCode")),1),u.value?(C(),b(O,{key:0},[m("("+l(u.value)+")s",1)],64)):q("v-if",!0)]),_:1})],2)],2),a("div",ie,[f(R,{name:"exchange"}),a("p",{onClick:F},l(n.value===1?t(e)("\u5207\u6362\u4E3A\u90AE\u7BB1\u9A8C\u8BC1"):t(e)("\u5207\u6362\u4E3A\u624B\u673A\u9A8C\u8BC1")),1)])]),a("div",ce,[f(T,{type:"primary",loading:g.value,onClick:L},{default:x(()=>[m(l(t(e)("nextStep")),1)]),_:1},8,["loading"])])])}}},ye=A(de,[["__scopeId","data-v-815bbfd7"],["__file","D:/caishen/mall-app-h5-vue/mall-app-h5-vue/src/views/verifyPage/index.vue"]]);export{ye as default};
