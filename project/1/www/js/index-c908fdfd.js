import{_ as te,ai as ae,l as oe,u as le,r as l,j as se,q as ne,ct as ue,g as ie,O as re,c as _,e as v,w as $,a as t,y as m,t as u,h as ve,v as ce,f as A,F as de,b as pe,T as i,cu as me,cv as z,cw as fe,b1 as ge,o as C,R as he,S as ye}from"./index-d71e1836.js";import{B as _e}from"./index-2b37af5f.js";import{P as Ae,N as Ce}from"./index-47042e81.js";import{E as F}from"./index-9bd62cf1.js";import{a as be}from"./login.api-d786b76a.js";import{n as Ve}from"./nationalityList-d81977c3.js";import{u as we}from"./index-ad39d8a5.js";import{I as Se}from"./index-f0979060.js";import"./index-27d29771.js";import"./index-ac66dd73.js";import"./use-id-7082c426.js";import"./index-ab1a8da6.js";import"./index-b1a171b4.js";import"./countryList-016fc82e.js";const Be="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAYAAAByDd+UAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAKzSURBVHgBvVZdbtpAEP5214G+VOUI9ATlBqEnKDlB4CVV1JeitJHSKIqjCJCaEsRDFYVUIj1BuEHICUJPUN+gPDY23unuEsjaQLDz00+yZHt29tud2Z35GFKi9vV7AYIXGHiOJHLg0pMS3t7nzX4Sf5Zk0OHRSdHhYp2AkvrM3TO0F8qwvYi80ep07yVsNE7ylHW6ICoiDQgDPwjX3J1NzyZTESnzRT714x/rlBHXC8iG6vFun1kwFDIZ8bvePP1ok41Nc9Bone2TJDdOov61QaPe7vaHgW0weWVOiXOmw563bcTYgBEV7tYSw+G305Jg7CLiRGgHYsV1q5UhlqB2dOoyzvYX2SOEOmfIiEt7lRSisru9cY4UqDVPygyiO88WzWFG7EdCIqmalsxMysXqItt0h+ZEqkRbhvOdrY0KUsI+IHMXM3khh5dsww0PD/DEZBFCVT3eTV717tzq3R16KrIooXXfJHCFFEhKpuGMHVT+pPU3DAZIgZu/JvyJUmAIRyPkhXVeiWf/IAXsErYMhsZxkNjhsTCEN3gRqSBEwWs8Ewzhbcka3v3kRTwTHOu9j3G/AxNsFU+EerNzobuHmZfQnx6VkOjndBShqJsuHglTm/UmSJVL9ejrNiXc+/S+Byusgouu2+rm8BioRmB9eQFf6UWKNyGsWp/5jPS7eCDqrbNWrBG09VmZ6Yf1486lDqm1jJ7vy2rSu+a63Vz2VdCKVR7vy9aGOfkzEsNnK2ssIh1YScmFy1qzU15GpvOefRlcx8l8Hr6dzjbPUZc6yGgjnjgrhz6BfoVSmvLHOfIMzhsViTJmFZ0hsxvBQtVm6mvIXTC2joeAWN8Xo0q86yzVpVoucMSUwP3w1NiD3a35SiGRENbQ+eFMlJRAeoOxCpuEb6h2o0joSlLYS6rA/xv+AZfLLFBKDLSAAAAAAElFTkSuQmCC";const ke=b=>(he("data-v-59a3607d"),b=b(),ye(),b),Ee={class:"bindVerify h-full bg-white"},Ie={class:"content"},$e={key:0},Te={style:{"margin-top":"22px"}},Ue={class:"label mt-2 textColor"},xe={class:"iptbox inputBackground"},Ne=["placeholder"],Re={style:{"margin-top":"22px"}},Pe={key:1},ze={class:"pl-30 pr-30 text-center flex flex-col items-center justify-center mt40"},Fe={class:"imgbox"},Ge={class:"code flex items-center justify-center textColor"},He={class:"tips"},Oe={class:"flex justify-between mt-6 mb-3"},je={class:"flex items-center"},qe=ke(()=>t("div",{class:"mt-2"},null,-1)),De={class:"mt-5 bottom tabBackground textColor"},Ze={__name:"index",setup(b){const B=ae(),T=oe(),{t:n}=le(),{toClipboard:G}=we(),V=l(""),s=l(""),f=l(""),U=l(!1),a=l(0),k=l(""),w=l(""),S=l(""),g=l(!1),c=l("");l(!0);const x=l(""),p=l(0),h=l(null),d=l(0),N=l(""),H=se(),y=l(!1);ne(()=>{console.log("ss"),O(),clearInterval(h.value),h.value=null});const O=()=>{a.value=B.query.type,k.value=B.query.verifyCode||"",a.value==1?(V.value=n("bindPhone"),U.value=!0):a.value==2?V.value=n("bindEmail"):a.value==3&&(V.value=n("googleAuthenticatorEn"),R())},j=async()=>{const e=/^[A-Za-z0-9\u4e00-\u9fa5]+@[a-zA-Z0-9_-]+(\.[a-zA-Z0-9_-]+)+$/;if(a.value==2&&s.value==""){i(n("entryEmail"));return}if(a.value==2&&!e.test(s.value)){i(n("\u8BF7\u8F93\u5165\u6B63\u786E\u7684\u90AE\u7BB1\u5730\u5740"));return}if(a.value==1&&s.value==""){i(n("entryPhone"));return}if(a.value==1&&!/^[0-9]+$/.test(s.value)){i(n("\u8BF7\u8F93\u5165\u6B63\u786E\u7684\u624B\u673A\u53F7\u7801"));return}if(d.value>0)return!1;i.loading({mask:!0}),await me({target:a.value==1?`${p.value} ${s.value}`:s.value}),be({target:a.value==1?`${p.value} ${s.value}`:s.value}).then(o=>{i(n("sendSuccess")),d.value=30,h.value=setInterval(()=>{d.value>0?d.value=d.value-1:(d.value=0,clearInterval(h.value),h.value=null)},1e3)}).catch(()=>{i.clear()})},q=()=>{if(a.value==2&&s.value==""){i(n("entryEmail"));return}if(a.value==1&&s.value==""){i(n("entryPhone"));return}if(f.value==""){i(n("\u8BF7\u8F93\u5165\u767B\u5F55\u5BC6\u7801"));return}y.value=!0,a.value==1?Z():a.value==2?D():a.value==3&&J()},E=async()=>{await H.getUserInfo(!0),i(n("bindSuccess")),y.value=!1,setTimeout(()=>{B.query.reset?T.go(-2):T.back()},1e3)},D=()=>{z({target:s.value,email:s.value,verifcode:w.value,password:f.value,verifyCode:k.value}).then(e=>{E()}).catch(e=>{console.log(e),y.value=!1})},Z=()=>{z({target:`${p.value} ${s.value}`,phone:`${p.value} ${s.value}`,verifcode:w.value,password:f.value,verifyCode:k.value}).then(e=>{E()}).catch(e=>{console.log(e),y.value=!1})},R=()=>{ue({}).then(e=>{S.value=e.google_auth_secret,x.value=e.google_auth_url,console.log(e)})},J=()=>{fe({secret:S.value,code:c.value}).then(e=>{e.google_auth_bind?E():i(err||n("bindFailed"))})},X=async()=>{try{await G(S.value),i(n("copySuccess"))}catch(e){console.error(e)}},Y=async()=>{c.value=await navigator.clipboard.readText()},K=(e,o,I)=>{N.value=o,p.value=I},P=l(null),M=()=>{P.value.open()};return ie(c,(e,o)=>{c.value.length===6&&(g.value=!1)}),(e,o)=>{const I=ge,W=re,L=Ae,Q=Ce,ee=_e;return C(),_("div",Ee,[v(I,null,{title:$(()=>[A(u(V.value),1)]),_:1}),t("div",Ie,[m(" \u624B\u673A\u90AE\u7BB1\u9A8C\u8BC1 "),a.value==1||a.value==2?(C(),_("div",$e,[t("div",Te,[v(F,{label:a.value==2?e.$t("email"):e.$t("phoneNum"),placeholderText:a.value==2?e.$t("entryEmail"):e.$t("entryPhone"),modelValue:s.value,"onUpdate:modelValue":o[0]||(o[0]=r=>s.value=r),area:U.value,onSelectArea:M,dialCode:p.value,icon:N.value},null,8,["label","placeholderText","modelValue","area","dialCode","icon"])]),t("p",Ue,u(e.$t("verificationCode")),1),t("div",xe,[ve(t("input",{class:"inputBackground textColor",type:"text",placeholder:e.$t("entryVerifyCode"),"onUpdate:modelValue":o[1]||(o[1]=r=>w.value=r)},null,8,Ne),[[ce,w.value]]),a.value!=3?(C(),_("span",{key:0,onClick:j},[A(u(e.$t("sendVerifyCode")),1),d.value?(C(),_(de,{key:0},[A(" ("+u(d.value)+")s",1)],64)):m("v-if",!0)])):m("v-if",!0)]),t("div",Re,[v(F,{label:e.$t("\u767B\u5F55\u5BC6\u7801"),placeholderText:e.$t("\u8BF7\u8F93\u5165\u767B\u5F55\u5BC6\u7801"),modelValue:f.value,"onUpdate:modelValue":o[2]||(o[2]=r=>f.value=r),typeText:"password",clearBtn:!1},null,8,["label","placeholderText","modelValue"])])])):m("v-if",!0),m(" \u8C37\u6B4C\u9A8C\u8BC1 "),a.value==3?(C(),_("div",Pe,[t("div",ze,[t("div",Fe,[v(pe(Se),{src:x.value},{loading:$(()=>[v(W,{type:"spinner",size:"20"})]),_:1},8,["src"])]),t("div",Ge,[A(u(S.value)+" ",1),t("img",{src:Be,alt:"",onClick:R})]),t("p",He,u(e.$t("saveKeyTips")),1),t("div",{class:"copy textColor",onClick:X},u(e.$t("copy")),1)]),t("div",Oe,[t("div",null,u(e.$t("googleVerificationCode")),1),t("div",je,[t("div",{class:"colorMain",onClick:o[3]||(o[3]=r=>c.value="")},u(e.$t("clear")),1),t("div",{class:"colorMain ml-30",onClick:Y},u(e.$t("paste")),1)])]),v(L,{value:c.value,gutter:16,focused:g.value,onFocus:o[4]||(o[4]=r=>g.value=!0),mask:!1},null,8,["value","focused"]),v(Q,{modelValue:c.value,"onUpdate:modelValue":o[5]||(o[5]=r=>c.value=r),show:g.value,onBlur:o[6]||(o[6]=r=>g.value=!1)},null,8,["modelValue","show"]),qe,t("div",De,[t("p",null,u(e.$t("precautions")),1),t("p",null,u(e.$t("precautionsTips1")),1),t("p",null,u(e.$t("precautionsTips2")),1)])])):m("v-if",!0),v(ee,{class:"w-full",style:{"margin-top":"30px"},type:"primary",loading:y.value,onClick:q},{default:$(()=>[A(u(e.$t("confirm")),1)]),_:1},8,["loading"])]),v(Ve,{ref_key:"controlChildRef",ref:P,title:e.$t("selectArea"),onGetName:K},null,8,["title"])])}}},nt=te(Ze,[["__scopeId","data-v-59a3607d"],["__file","D:/caishen/mall-app-h5-vue/mall-app-h5-vue/src/views/bindVerify/index.vue"]]);export{nt as default};
