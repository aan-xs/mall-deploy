import{_ as U,j as L,u as R,ai as A,l as D,r as u,q as E,i as j,m as z,c as b,e as h,w as x,a as o,t as r,b as e,y as w,f as _,n as N,T as y,cn as H,b1 as M,o as C,cm as O,F as P,R as G,S as J}from"./index-d71e1836.js";import{B as K}from"./index-2b37af5f.js";import"./index-27d29771.js";import{F as Q}from"./index-ac66dd73.js";import{a as W}from"./login.api-d786b76a.js";import"./use-id-7082c426.js";const X=v=>(G("data-v-1ca2bd92"),v=v(),J(),v),Y={class:"verify-content"},Z=X(()=>o("div",{style:{height:"46px"}},null,-1)),$={class:"info-content"},ee={class:"info-item"},ae={class:"info-item"},te={class:"gap"},se={key:0},oe={class:"submit-content"},ne={__name:"index",setup(v){const d=L(),{t:a}=R(),g=A(),I=D(),n=u(1),V=u("44"),f=u(""),l=u(0),p=u(null),m=u(!1);n.value=g.query&&g.query.type?Number(g.query.type):1,E(()=>{clearInterval(p.value),p.value=null});const k=j(),B=z(()=>{if(!d.userInfo.token)I.push("/login");else{const{email:c,phone:t}=d.userInfo;let s="";if(n.value===1){if(t){const i=t.split(" ");i.length===2?(V.value=i[0],s=i[1]):s=i[0]}}else s=c||"";return s}}),T=()=>{if(l.value>0)return!1;const{email:c,phone:t}=d.userInfo;y.loading({duration:0,forbidClick:!0}),W({target:n.value===1?t:c}).then(()=>{y(a("sendSuccess")),l.value=60,p.value=setInterval(()=>{l.value>0?l.value=l.value-1:(l.value=0,clearInterval(p.value),p.value=null)},1e3)}).catch(()=>{y.clear()})},q=async()=>{if(f.value===""){y(a("entryVerifyCode"));return}m.value=!0;const{email:c,phone:t}=d.userInfo,s={target:n.value===1?t:c,verifcode:f.value};n.value===1?s.phone=t:s.email=c,H(s).then(async i=>{await d.getUserInfo(!0),m.value=!1,I.back()}).catch(()=>{m.value=!1})};return(c,t)=>{const s=M,i=Q,S=K;return C(),b("div",Y,[h(s,{fixed:!0},{title:x(()=>[_(r(n.value===1?e(a)("\u624B\u673A\u9A8C\u8BC1"):e(a)("\u90AE\u7BB1\u9A8C\u8BC1")),1)]),_:1}),Z,o("div",$,[o("div",ee,[o("p",null,r(e(a)("\u4E3A\u4E86\u4FDD\u969C\u60A8\u7684\u8D26\u53F7\u5B89\u5168\uFF0C\u8BF7\u9A8C\u8BC1\u540E\u8FDB\u884C\u4E0B\u4E00\u6B65\u64CD\u4F5C")),1)]),o("div",ae,[o("p",te,r(n.value===1?e(a)("\u5F53\u524D\u7ED1\u5B9A\u624B\u673A\u53F7"):e(a)("\u5F53\u524D\u7ED1\u5B9A\u90AE\u7BB1")),1),o("h2",null,[n.value===1?(C(),b("span",se,"(+"+r(V.value)+")",1)):w("v-if",!0),_(r(e(O)(e(B),!1)),1)])]),o("div",{class:N(["code-content",{"is-ar":e(k)}])},[h(i,{modelValue:f.value,"onUpdate:modelValue":t[0]||(t[0]=F=>f.value=F),type:"tel",label:"",placeholder:e(a)("entryVerifyCode")},null,8,["modelValue","placeholder"]),o("div",{class:N(["btn",{"is-ar":e(k)}])},[h(S,{type:"primary",onClick:T},{default:x(()=>[_(r(e(a)("sendVerifyCode")),1),l.value?(C(),b(P,{key:0},[_("("+r(l.value)+")s",1)],64)):w("v-if",!0)]),_:1})],2)],2)]),o("div",oe,[h(S,{type:"primary",loading:m.value,onClick:q},{default:x(()=>[_(r(e(a)("confirm")),1)]),_:1},8,["loading"])])])}}},pe=U(ne,[["__scopeId","data-v-1ca2bd92"],["__file","D:/caishen/mall-app-h5-vue/mall-app-h5-vue/src/views/certified/index.vue"]]);export{pe as default};
