import{D as ae,K as Y,J as Z,a6 as se,Z as te,bG as oe,d as le,aD as ne,r as k,m as re,bK as ie,ad as ce,e as f,a9 as ue,I as H,aU as K,N as _e,P as de,_ as ge,i as me,u as ve,c as I,w as $,a as n,b1 as fe,o as A,f as pe,t as R,b as h,F as J,x as Q,n as W,y as g,aG as he,b4 as be,z as ye,bL as Ae,bM as xe,bN as Ve,bO as we,bP as Ie,bQ as Re,bR as ke,bS as Ce,bT as Pe,bU as Se,bV as Ne,bW as Ue,bX as Ee,bY as Te,bZ as Le,b_ as ze,b$ as $e,c0 as Me,c1 as Fe,c2 as Be,c3 as De}from"./index-d71e1836.js";import{P as He}from"./index-e1abf70a.js";import{L as je}from"./index-bc764d2b.js";import{E as Ge}from"./index-3362e25b.js";import{I as Oe}from"./index-2b91c1c1.js";import{f as Xe}from"./product.api-4494d699.js";import{u as Ye}from"./use-refs-6733bf03.js";import{I as Ze}from"./index-f0979060.js";import"./use-id-7082c426.js";import"./index-425c94da.js";import"./index-43614c31.js";import"./stringify-da9bcf3c.js";import"./___vite-browser-external_commonjs-proxy-74327c81.js";const[Ke,M]=ae("rate");function Je(a,m,u,c){return a>=m?{status:"full",value:1}:a+.5>=m&&u&&!c?{status:"half",value:.5}:a+1>=m&&u&&c?{status:"half",value:Math.round((a-m+1)*1e10)/1e10}:{status:"void",value:0}}const Qe={size:Y,icon:Z("star"),color:String,count:se(5),gutter:Y,readonly:Boolean,disabled:Boolean,voidIcon:Z("star-o"),allowHalf:Boolean,voidColor:String,touchable:te,iconPrefix:String,modelValue:oe(0),disabledColor:String};var We=le({name:Ke,props:Qe,emits:["change","update:modelValue"],setup(a,{emit:m}){const u=ne(),[c,p]=Ye(),b=k(),x=()=>a.readonly||a.disabled||!a.touchable,V=re(()=>Array(+a.count).fill("").map((s,e)=>Je(a.modelValue,e+1,a.allowHalf,a.readonly)));let r,y,C=Number.MAX_SAFE_INTEGER,P=Number.MIN_SAFE_INTEGER;const S=()=>{y=K(b);const s=c.value.map(K);r=[],s.forEach((e,t)=>{C=Math.min(e.top,C),P=Math.max(e.top,P),a.allowHalf?r.push({score:t+.5,left:e.left,top:e.top,height:e.height},{score:t+1,left:e.left+e.width/2,top:e.top,height:e.height}):r.push({score:t+1,left:e.left,top:e.top,height:e.height})})},N=(s,e)=>{for(let t=r.length-1;t>0;t--)if(e>=y.top&&e<=y.bottom){if(s>r[t].left&&e>=r[t].top&&e<=r[t].top+r[t].height)return r[t].score}else{const _=e<y.top?C:P;if(s>r[t].left&&r[t].top===_)return r[t].score}return a.allowHalf?.5:1},U=s=>{!a.disabled&&!a.readonly&&s!==a.modelValue&&(m("update:modelValue",s),m("change",s))},o=s=>{x()||(u.start(s),S())},i=s=>{if(!x()&&(u.move(s),u.isHorizontal())){const{clientX:e,clientY:t}=s.touches[0];_e(s),U(N(e,t))}},v=(s,e)=>{const{icon:t,size:_,color:w,count:E,gutter:l,voidIcon:T,disabled:d,voidColor:L,allowHalf:F,iconPrefix:j,disabledColor:G}=a,B=e+1,D=s.status==="full",z=s.status==="void",q=F&&s.value>0&&s.value<1;let O;l&&B!==+E&&(O={paddingRight:ue(l)});const ee=X=>{S(),U(F?N(X.clientX,X.clientY):B)};return f("div",{key:e,ref:p(e),role:"radio",style:O,class:M("item"),tabindex:d?void 0:0,"aria-setsize":E,"aria-posinset":B,"aria-checked":!z,onClick:ee},[f(H,{size:_,name:D?t:T,class:M("icon",{disabled:d,full:D}),color:d?G:D?w:L,classPrefix:j},null),q&&f(H,{size:_,style:{width:s.value+"em"},name:z?T:t,class:M("icon",["half",{disabled:d,full:!z}]),color:d?G:z?L:w,classPrefix:j},null)])};return ie(()=>a.modelValue),ce("touchmove",i,{target:b}),()=>f("div",{ref:b,role:"radiogroup",class:M({readonly:a.readonly,disabled:a.disabled}),tabindex:a.disabled?void 0:0,"aria-disabled":a.disabled,"aria-readonly":a.readonly,onTouchstartPassive:o},[V.value.map(v)])}});const qe=de(We);const ea={class:"comment"},aa={class:"list"},sa={class:"flex score"},ta={class:"flex user-name"},oa=["src"],la={class:"text-black text-sm"},na={class:"comment-text pt-3 pb-3",style:{color:"#666"}},ra={class:"flex overflow-x-auto mb-3"},ia=["onClick","src"],ca={class:"item py-1 flex"},ua={class:"flex-1 flex left"},_a=["onClick"],da={class:"product-info flex-1"},ga={class:"name"},ma={class:"flex justify-between"},va={class:"money"},fa={class:"comment-time"},pa={__name:"comment",setup(a){const m=me(),{t:u}=ve(),c=k([]),p=k(!1),b=k(!1);let x=k(1);const V=k(!1),r=new URL("/www/png/name-20d65991.png",self.location),y=o=>{Oe([o])},C=()=>{c.value=[],b.value=!1,p.value=!1,x.value=1,S()},P=o=>{const i=[];return Object.keys(o).forEach(v=>{v.indexOf("imgUrl")>-1&&o[v]&&i.push(o[v])}),i},S=()=>{console.log(123);const o={pageNum:x.value,pageSize:20};Xe(o).then(i=>{V.value=!1;const{pageInfo:v,pageList:s}=i;console.log(i);const e=s||[];e.map(_=>{_.avatar=_.avatar||Math.floor(Math.random()*20)});const t=e.sort((_,w)=>w.createTime/1-_.createTime/1);c.value=c.value.concat(t),console.log("\u6392\u5E8F\u540E\u7684\u5217\u8868",c.value),x.value++,p.value=!1,b.value=e.length<v.pageSize}).catch(()=>{b.value=!0,p.value=!1,V.value=!1})},N=o=>new URL(Object.assign({"/src/assets/image/userAvatar/1.png":Ae,"/src/assets/image/userAvatar/10.png":xe,"/src/assets/image/userAvatar/11.png":Ve,"/src/assets/image/userAvatar/12.png":we,"/src/assets/image/userAvatar/13.png":Ie,"/src/assets/image/userAvatar/14.png":Re,"/src/assets/image/userAvatar/15.png":ke,"/src/assets/image/userAvatar/16.png":Ce,"/src/assets/image/userAvatar/17.png":Pe,"/src/assets/image/userAvatar/18.png":Se,"/src/assets/image/userAvatar/19.png":Ne,"/src/assets/image/userAvatar/2.png":Ue,"/src/assets/image/userAvatar/20.png":Ee,"/src/assets/image/userAvatar/3.png":Te,"/src/assets/image/userAvatar/4.png":Le,"/src/assets/image/userAvatar/5.png":ze,"/src/assets/image/userAvatar/6.png":$e,"/src/assets/image/userAvatar/7.png":Me,"/src/assets/image/userAvatar/8.png":Fe,"/src/assets/image/userAvatar/9.png":Be,"/src/assets/image/userAvatar/default.png":De})[`/src/assets/image/userAvatar/${o}.png`],self.location).href;function U(o){let i=o.substring(2,o.length-1);return o.replace(i,"***")}return(o,i)=>{const v=fe,s=qe,e=H,t=Ze,_=Ge,w=je,E=He;return A(),I("div",ea,[f(v,{fixed:""},{title:$(()=>[pe(R(h(u)("product.23")),1)]),_:1}),n("div",aa,[f(E,{modelValue:V.value,"onUpdate:modelValue":i[1]||(i[1]=l=>V.value=l),"loading-text":o.$t("\u52A0\u8F7D\u4E2D"),"loosing-text":o.$t("\u91CA\u653E\u4EE5\u5237\u65B0"),"pulling-text":o.$t("\u4E0B\u62C9\u4EE5\u5237\u65B0"),onRefresh:C},{default:$(()=>[f(w,{loading:p.value,"onUpdate:loading":i[0]||(i[0]=l=>p.value=l),"loading-text":o.$t("\u52A0\u8F7D\u4E2D"),finished:b.value,"finished-text":c.value.length?h(u)("product.3"):"",onLoad:S},{default:$(()=>[c.value.length?(A(!0),I(J,{key:0},Q(c.value,(l,T)=>(A(),I("div",{class:W(["pl-3 pr-3 pt-4 comment-info pb-5",{"is-ar":h(m)}]),key:T},[n("div",sa,[n("div",ta,[g('                <img class="user-img" :src="item.avatar ? `avatar/head_${item.avatar}.jpg` : `avatar/avatar_d.png`" />'),n("img",{class:"user-img",src:N(l.avatar)},null,8,oa),n("span",la,R(U(l.userName)),1)]),n("div",null,[f(s,{size:20,color:"#FFC93E",modelValue:l.rating,"onUpdate:modelValue":d=>l.rating=d},null,8,["modelValue","onUpdate:modelValue"])])]),n("div",na,R(l.content||h(u)("\u7528\u6237\u672A\u53D1\u8868\u8BC4\u8BBA")),1),n("div",ra,[(A(!0),I(J,null,Q(P(l),(d,L)=>(A(),I("img",{onClick:F=>y(d),class:W(["w-1/4 img-icon",h(m)?"ml-1.5":"mr-1.5"]),key:"imgs"+L,src:d,alt:""},null,10,ia))),128))]),n("div",ca,[n("div",ua,[l.goodsVo.imgUrl1?(A(),I("div",{key:0,class:"product-img-wrap w-28 h-28",onClick:d=>y(l.goodsVo.imgUrl1)},[f(t,{src:l.goodsVo.imgUrl1,class:"product-img"},{error:$(()=>[f(e,{name:"photo-fail"})]),_:2},1032,["src"]),g('                  <img class="product-img" style="object-fit: cover" :src="item.imgUrl1" />')],8,_a)):g("v-if",!0),n("div",da,[n("div",ga,R(l.goodsVo.name),1),g('                  <div class="Specification">'),g("                    <span>{{ fullCategory(item.goodsVo.id) }}</span>"),g("                    <span>{{t('product.4')}}: {{item.goodsVo.unit}}</span>"),g(" <span>Sales: 1000</span> "),g("                  </div>"),n("div",ma,[n("div",va,"$"+R(h(he)(l.goodsVo.systemPrice)),1),n("div",fa,R(h(be)(l.commentTime)),1)])])])])],2))),128)):g("v-if",!0),!c.value.length&&!p.value?(A(),ye(_,{key:1,image:h(r).href,description:h(u)("noData")},null,8,["image","description"])):g("v-if",!0),g(`          <van-empty :description="$t('noMore')" v-else/>`)]),_:1},8,["loading","loading-text","finished","finished-text"])]),_:1},8,["modelValue","loading-text","loosing-text","pulling-text"])])])}}},Na=ge(pa,[["__scopeId","data-v-97bfea85"],["__file","D:/caishen/mall-app-h5-vue/mall-app-h5-vue/src/views/product/comment.vue"]]);export{Na as default};
