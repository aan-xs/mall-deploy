import{_,d as F,u as E,r as d,T as v,B as I,a$ as Q,aw as D,c as p,e as f,w as S,a as o,F as M,x as V,y as x,b0 as y,b1 as T,o as g,f as k,t as A,R as N,S as X}from"./index-d71e1836.js";import{B as q}from"./index-2b37af5f.js";import{S as z,a as r}from"./index-1eee9ab8.js";import{u as H}from"./upload.api-2af08ed0.js";const Y=F({name:"ShopBanner",components:{VuePictureCropper:z},setup(){const{t:e}=E(),R=d(localStorage.getItem("sellerId")||""),U=new URL("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFgAAABYCAYAAABxlTA0AAAACXBIWXMAABYlAAAWJQFJUiTwAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAThSURBVHgB7ZxdTttaEMeHDyFEQMoOrnfQsIJrVgCR+Hy6zgpu7wpIV9DeFeA+QQhS6QpqVkC6gywhL8lLCPQ/xa4QTY5PSjxnWuYnRU7k48T5e3zOnJk5JjIMwzAMwzAUskRKODs7q29sbLxdWVn5i15GNh6Pb05OTvqkABUCn5+fRxD2C95GtBj6k8lkR4PIwQWuQNwCFSIHFbhCcQuCixxMYAFxC4KKHERgQXELgoksLnAAcQuCiCwqcEBxC8RFFhNYgbgFoiKLCKxI3AIxkSsXWKG4BSIizyUwT2drtdrew8PDG4hW9znm/v4+Jn3iFvSXl5czn4a4GANsbo6Ojq5pDrwF7na7b7E5hbhewv7B8EVp7+/vf/Rp7CVwp9NpLy0tnZLxAxjaO1hzu6xdqcCXl5cJNmdk/AS6v/+Oj48/uNosUzlmuTNAV3HK45KzjWvn1dXVHukdoDRQ39ra2nU1cAqMfuZvMpzAu2i49q+6dmrxGHAefQyyfbzlV/3Jq0GBwXk5NXIKHJABRE1x8tfD4fBrq9UazGqIQZjvsgTtY7SPSBnaBM7wah8eHt74HpC3/d4es8aEBx5NQmsReACXpw2X5396AZj2ptikFxcXnDxVMSnycdMqBSL0MFBsv1Tcp7Bvend3t819NwUmqMCw2nQ0GlUScOHvXFtb28bbuWIHiyZkF3ENS2tRhTSbTR4cm5jq84D5DwUgiAXzrQvvoFJxnwJL5kBVjwIQwoJ5QNtxuV5PgRvGcZBkxu4UXkTphWJLhofRXF1dvZUe+MQtmL2FENld/k0Mpu9IGFGBuWtYpLcwL3nkKyNBpC24TYGRtmIxgdl6EaD2ygJUCbqKDB6FV/+/CMQExp/KSA8pCSHZRaSkBMzyPpMQYm6aK4CDwP7MlFSelZ5F7DoWicmpLtz6+npvPB6TBCICc7zBtR8iJvRrRCXHThWY/WL4130SyNaIdBGSg4oveQC/ckQEhgWrE1gq0vZqLZgeU06VI+VFRKSMslzaoni1ApOQBUu5aREXaDgiaOmsA13JzDzbnNEvgGNFMtJifjB8T/5D2bR9rpCjK1zJ4vqEK5/T7XZjCEwSiM3kkO3dJSVAXLHshmQsIiE9xCSEZCyijqxCTIHJq0UjEkI0Hsy1ChQe0XOQDrjHXBRCgcir9CMSRDwnx6VNvDCGhMl/U/wOCpFVrkPkT/CLvTLLuRv2ohQ/++C80ilEKVWQugh4FI1arfaehMBvsS8dUQBCVvYknU6nPhqNWr41EvOSP0WFM8l7FIigtWmw5D1Y120VfTJ/J777S6iSqYLg1ZWAV4LeLtK7YG+Bq3hIQQW8lvpgHvjeYxLw7zyL/J7DMQZ6XCwZkxK0Vbhzji2F0G285/qFjwcHB9msxtzHbm5uNnDMLi5MonEVqtY1GhE9rrtIIDZ/7nFWhFNPEJK3Eb+4HUfFsI+komPzolXg5zQKAWGt9DuhYZD7ozGBK8YErhinwErT7aooK2BxCixZJPe7gsE3c+33eV4EP28nJmManHTdcTUo7YMnk0nLuoqpDFibskalAvPiEdwGOxpWTSqCDc5rAaWXF4HboMdLr0hREXUgeBb5gZf+siY+B8z93LT80V5vuLYLor+aJ1Dh/34dDof9qmLXhmEYhmEYhmEYhmEYhmF8AwdhLA50cpBqAAAAAElFTkSuQmCC",self.location),n=d([{name:`${e("storeBanner")} 1(1920X300)`,id:"banner1",dataURL:"",blobURL:"",file:"",imgUrl:""},{name:`${e("storeBanner")} 2(1920X300)`,id:"banner2",dataURL:"",blobURL:"",file:"",imgUrl:""},{name:`${e("storeBanner")} 3(1920X300)`,id:"banner3",dataURL:"",blobURL:"",file:"",imgUrl:""}]);v.loading({duration:0,message:e("loading"),forbidClick:!0}),I().then(t=>{n.value[0].dataURL=t.banner1||"",n.value[1].dataURL=t.banner2||"",n.value[2].dataURL=t.banner3||"",v.clear()}).catch(()=>{v.clear()});const c=d(!1),h=d(""),l=d(null),b=(t,a)=>{h.value="",n.value[a].dataURL="",n.value[a].blobURL="",n.value[a].file="",l.value=a;const{files:s}=t.target;if(!s||!s.length)return;const L=s[0],m=new FileReader;m.readAsDataURL(L),m.onload=()=>{h.value=String(m.result),c.value=!0}},C=async()=>{if(!r)return;const t=r.getDataURL(),a=await r.getBlob();if(!a)return;const s=await r.getFile();if(l.value===null)return c.value=!1,!1;n.value[l.value].dataURL=t,n.value[l.value].blobURL=URL.createObjectURL(a),n.value[l.value].file=s,c.value=!1},B=()=>{!r||(r.clear(),r.reset(),c.value=!1)},u=async t=>{for(let a=0;a<t.length;a++)await H({file:t[a].file,moduleName:t[a].id}).then(s=>{const L=n.value.find(m=>m.id===t[a].id);L.imgUrl=s})},i=d(!1);return{bannerImg:U,bannerData:n,submitLoading:i,isShowModal:c,cropperImage:h,showBtn:R,t:e,selectFile:b,getResult:C,croperBack:B,submitHandle:async()=>{const t=n.value.filter(a=>a.file);if(t.length){i.value=!0;try{await u(t)}catch(s){return i.value=!1,!1}const a={};t.forEach(s=>{a[s.id]=s.imgUrl}),y(a).then(()=>{i.value=!1,n.value.map(s=>{s.file="",s.imgUrl=""}),v.success(e("saveSuc"))}).catch(()=>{i.value=!1})}else v(e("noNeedSub"))}}}}),J=e=>(N("data-v-4732ee21"),e=e(),X(),e),W=J(()=>o("div",{style:{height:"46px"}},null,-1)),j={class:"banner-content"},K={class:"title"},G={class:"img-content"},P=["onChange"],Z=["src"],O={key:1,class:"default"},$=["src"],ee={class:"submit-btn"},ae={key:0,class:"croper-content-modal"};function te(e,R,U,n,c,h){const l=T,b=q,C=Q,B=D("VuePictureCropper");return g(),p("div",null,[f(l,{fixed:!0},{title:S(()=>[k(A(e.t("bannerSet")),1)]),_:1}),W,o("div",j,[(g(!0),p(M,null,V(e.bannerData,(u,i)=>(g(),p("div",{key:u.id,class:"item"},[o("div",K,A(u.name),1),o("div",G,[o("input",{type:"file",accept:"image/jpg, image/jpeg, image/png, image/gif",onChange:w=>e.selectFile(w,i)},null,40,P),u.dataURL?(g(),p("img",{key:0,src:u.dataURL,alt:""},null,8,Z)):(g(),p("div",O,[o("img",{src:e.bannerImg,alt:""},null,8,$),o("p",null,A(e.t("addBanner")),1)]))])]))),128)),o("div",ee,[f(b,{loading:e.submitLoading,type:"primary",size:"large",disabled:!e.showBtn,onClick:e.submitHandle},{default:S(()=>[k(A(e.showBtn?e.t("save"):e.t("\u5546\u5BB6\u5165\u9A7B\u5C1A\u672A\u5B8C\u6210")),1)]),_:1},8,["loading","disabled","onClick"])])]),e.isShowModal?(g(),p("div",ae,[f(C,{title:e.t("selectPhotos"),"right-text":e.t("sure"),"left-arrow":"",fixed:"",onClickLeft:e.croperBack,onClickRight:e.getResult},null,8,["title","right-text","onClickLeft","onClickRight"]),f(B,{boxStyle:{width:"100%",height:"100%",backgroundColor:"#f8f8f8",margin:"auto"},img:e.cropperImage,options:{viewMode:1,dragMode:"crop",aspectRatio:1920/300}},null,8,["img"])])):x("v-if",!0)])}const ie=_(Y,[["render",te],["__scopeId","data-v-4732ee21"],["__file","D:/caishen/mall-app-h5-vue/mall-app-h5-vue/src/views/shop/banner/index.vue"]]);export{ie as default};
